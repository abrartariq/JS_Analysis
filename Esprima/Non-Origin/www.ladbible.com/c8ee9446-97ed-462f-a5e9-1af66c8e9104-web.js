/*! permutive-javascript-sdk v5.15.8 (web) (built 2019-04-05 14:57:38 UTC) */
!function(){function lzWorkerFunction(){var e=this;e.compress=function(e){if(null==e)return"";var t,n,i,r={},a={},s="",o="",c="",u=2,l=3,d=2,f=[],p=0,m=0,g=String.fromCharCode,v=function(e){return g(e+32)};for(i=0;i<e.length;i+=1)if(s=e.charAt(i),Object.prototype.hasOwnProperty.call(r,s)||(r[s]=l++,a[s]=!0),o=c+s,Object.prototype.hasOwnProperty.call(r,o))c=o;else{if(Object.prototype.hasOwnProperty.call(a,c)){if(c.charCodeAt(0)<256){for(t=0;t<d;t++)p<<=1,14===m?(m=0,f.push(v(p)),p=0):m++;for(n=c.charCodeAt(0),t=0;t<8;t++)p=p<<1|1&n,14===m?(m=0,f.push(v(p)),p=0):m++,n>>=1}else{for(n=1,t=0;t<d;t++)p=p<<1|n,14===m?(m=0,f.push(v(p)),p=0):m++,n=0;for(n=c.charCodeAt(0),t=0;t<16;t++)p=p<<1|1&n,14===m?(m=0,f.push(v(p)),p=0):m++,n>>=1}0===--u&&(u=Math.pow(2,d),d++),delete a[c]}else for(n=r[c],t=0;t<d;t++)p=p<<1|1&n,14===m?(m=0,f.push(v(p)),p=0):m++,n>>=1;0===--u&&(u=Math.pow(2,d),d++),r[o]=l++,c=String(s)}if(""!==c){if(Object.prototype.hasOwnProperty.call(a,c)){if(c.charCodeAt(0)<256){for(t=0;t<d;t++)p<<=1,14===m?(m=0,f.push(v(p)),p=0):m++;for(n=c.charCodeAt(0),t=0;t<8;t++)p=p<<1|1&n,14===m?(m=0,f.push(v(p)),p=0):m++,n>>=1}else{for(n=1,t=0;t<d;t++)p=p<<1|n,14===m?(m=0,f.push(v(p)),p=0):m++,n=0;for(n=c.charCodeAt(0),t=0;t<16;t++)p=p<<1|1&n,14===m?(m=0,f.push(v(p)),p=0):m++,n>>=1}0===--u&&(u=Math.pow(2,d),d++),delete a[c]}else for(n=r[c],t=0;t<d;t++)p=p<<1|1&n,14===m?(m=0,f.push(v(p)),p=0):m++,n>>=1;0===--u&&(u=Math.pow(2,d),d++)}for(n=2,t=0;t<d;t++)p=p<<1|1&n,14===m?(m=0,f.push(v(p)),p=0):m++,n>>=1;for(;;){if(p<<=1,14===m){f.push(v(p));break}m++}return f.join("")+" "},e.decompress=function(e){if(null==e)return"";if(""===e)return null;var t,n,i,r,a,s,o,c=e.length,u=function(t){return e.charCodeAt(t)-32},l=[],d=4,f=4,p=3,m="",g=[],v={val:u(0),position:16384,index:1},h=String.fromCharCode;for(t=0;t<3;t+=1)l[t]=t;for(i=0,a=Math.pow(2,2),s=1;s!==a;)r=v.val&v.position,v.position>>=1,0===v.position&&(v.position=16384,v.val=u(v.index++)),i|=(r>0?1:0)*s,s<<=1;switch(i){case 0:for(i=0,a=Math.pow(2,8),s=1;s!==a;)r=v.val&v.position,v.position>>=1,0===v.position&&(v.position=16384,v.val=u(v.index++)),i|=(r>0?1:0)*s,s<<=1;o=h(i);break;case 1:for(i=0,a=Math.pow(2,16),s=1;s!==a;)r=v.val&v.position,v.position>>=1,0===v.position&&(v.position=16384,v.val=u(v.index++)),i|=(r>0?1:0)*s,s<<=1;o=h(i);break;case 2:return""}for(l[3]=o,n=o,g.push(o);;){if(v.index>c)return"";for(i=0,a=Math.pow(2,p),s=1;s!==a;)r=v.val&v.position,v.position>>=1,0===v.position&&(v.position=16384,v.val=u(v.index++)),i|=(r>0?1:0)*s,s<<=1;switch(o=i){case 0:for(i=0,a=Math.pow(2,8),s=1;s!==a;)r=v.val&v.position,v.position>>=1,0===v.position&&(v.position=16384,v.val=u(v.index++)),i|=(r>0?1:0)*s,s<<=1;l[f++]=h(i),o=f-1,d--;break;case 1:for(i=0,a=Math.pow(2,16),s=1;s!==a;)r=v.val&v.position,v.position>>=1,0===v.position&&(v.position=16384,v.val=u(v.index++)),i|=(r>0?1:0)*s,s<<=1;l[f++]=h(i),o=f-1,d--;break;case 2:return g.join("")}if(0===d&&(d=Math.pow(2,p),p++),l[o])m=l[o];else{if(o!==f)return null;m=n+n.charAt(0)}g.push(m),l[f++]=n+m.charAt(0),n=m,0===--d&&(d=Math.pow(2,p),p++)}},e.onmessage=function(t){"compress"===t.data.type?e.postMessage({type:"compressed",result:e.compress(t.data.value)}):"decompress"===t.data.type&&e.postMessage({type:"decompressed",result:e.decompress(t.data.value)})}}function threeYearsFromNow(){var e=new Date;return e.setFullYear(e.getFullYear()+3),e.toUTCString()}function extractDomain(e){var t=e.match(/\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b/),n=e.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,24}$/i),i=e.match(/localhost/);if(n&&n.length>0){var r=e.split(".").reverse();return r.length>=3&&r[1].match(/^(com|edu|gov|net|mil|org|nom|co|ac|name|info|biz)$/i)?r[2]+"."+r[1]+"."+r[0]:r[1]+"."+r[0]}if(t&&t.length>0)return t[0];if(i&&i.length>0)return"localhost";throw"No domain can be found for cookies"}function initialiseSDK(){function makeSafe(e){return function(){try{return e.apply(this,arguments)}catch(e){_internals.error(e)}}}function QueryWorker(){var e=this,t=function(){var e=this&&this.__assign||function(){return(e=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)},t={k:function(e,t){return t.reduce(function(e,t){return e&&e[t]?e[t]:null},e)},kf:function(e,t,n){var i=t.reduce(function(e,t){return e&&e[t]?e[t]:null},e);return null===i?null:n(i)},ti:function(e){return e.getTime()},pre:function(e,t){var n=t.slice();return n.unshift(e),n},a0:function(e,t){return e&&t},o0:function(e,t){return e||t},n0:function(e){return!e},t:function(e){return!0},a:function(e,t){return function(n){return e(n)&&t(n)}},o:function(e,t){return function(n){return e(n)||t(n)}},i:function(e){return e},as:function(e,n,i){return function(r){return i.reduce(function(i,a){return i&&e(a)(t.k(r,t.pre("properties",n)))},!0)}},os:function(e,n,i){return function(r){return i.reduce(function(i,a){return i||e(a)(t.k(r,t.pre("properties",n)))},!1)}},e:function(e){return function(t){return t===e}},n:function(e){return function(t){return t!==e}},g:function(e){return function(t){return t>e}},ge:function(e){return function(t){return t>=e}},l:function(e){return function(t){return t<e}},le:function(e){return function(t){return t<=e}},b:function(e,t){return function(n){return n>=e&&n<=t}},s:function(e){return function(t){return"string"==typeof e&&"string"==typeof t&&t.toLowerCase().indexOf(e.toLowerCase())>-1}},c:function(e){return function(t){return null!=t&&"object"==typeof t&&t.indexOf(e)>=0}},e_:function(e,n){return function(i){return t.k(i,e)===n}},n_:function(e,n){return function(i){return t.k(i,e)!==n}},g_:function(e,n){return function(i){return t.k(i,e)>n}},ge_:function(e,n){return function(i){return t.k(i,e)>=n}},l_:function(e,n){return function(i){return t.k(i,e)<n}},le_:function(e,n){return function(i){return t.k(i,e)<=n}},b_:function(e,n,i){return function(r){return t.k(r,e)>=n&&t.k(r,e)<=i}},s_:function(e,n){return function(i){var r=t.k(i,e);return"string"==typeof n&&"string"==typeof r&&r.toLowerCase().indexOf(n.toLowerCase())>-1}},c_:function(e,n){return function(i){var r=t.k(i,e);return null!=r&&"object"==typeof r&&r.indexOf(n)>=0}},pe:function(e,n){return function(i){return t.k(i,t.pre("properties",e))===n}},pn:function(e,n){return function(i){return t.k(i,t.pre("properties",e))!==n}},pg:function(e,n){return function(i){return t.k(i,t.pre("properties",e))>n}},pge:function(e,n){return function(i){return t.k(i,t.pre("properties",e))>=n}},pl:function(e,n){return function(i){return t.k(i,t.pre("properties",e))<n}},ple:function(e,n){return function(i){return t.k(i,t.pre("properties",e))<=n}},pb:function(e,n,i){return function(r){return t.k(r,t.pre("properties",e))>=n&&t.k(r,t.pre("properties",e))<=i}},ps:function(e,n){return function(i){var r=t.k(i,t.pre("properties",e));return"string"==typeof n&&"string"==typeof r&&r.toLowerCase().indexOf(n.toLowerCase())>-1}},pc:function(e,n){return function(i){var r=t.k(i,t.pre("properties",e));return null!=r&&"object"==typeof r&&r.indexOf(n)>=0}},te_:function(e,n){return function(i){return t.kf(i,e,t.ti)===n}},tn_:function(e,n){return function(i){return t.kf(i,e,t.ti)!==n}},tg_:function(e,n){return function(i){return t.kf(i,e,t.ti)>n}},tge_:function(e,n){return function(i){return t.kf(i,e,t.ti)>=n}},tl_:function(e,n){return function(i){return t.kf(i,e,t.ti)<n}},tle_:function(e,n){return function(i){return t.kf(i,e,t.ti)<=n}},tb_:function(e,n,i){return function(r){return t.kf(r,e,t.ti)>=n&&t.kf(r,e,t.ti)<=i}},te:function(e){return function(n){return t.kf(n,["time"],t.ti)===e}},tn:function(e){return function(n){return t.kf(n,["time"],t.ti)!==e}},tg:function(e){return function(n){return t.kf(n,["time"],t.ti)>e}},tge:function(e){return function(n){return t.kf(n,["time"],t.ti)>=e}},tl:function(e){return function(n){return t.kf(n,["time"],t.ti)<e}},tle:function(e){return function(n){return t.kf(n,["time"],t.ti)<=e}},tb:function(e,n){return function(i){return t.kf(i,["time"],t.ti)>=e&&t.kf(i,["time"],t.ti)<=n}},af_s:function(e,n,i,r){return void 0===r&&(r=function(e){return!0}),function(a){return i(t.k(a,e).filter(r).map(function(e){return t.k(e,n)}).reduce(function(e,t){return e+t},0))}},af_p:function(e,n,i,r){return void 0===r&&(r=function(e){return!0}),function(a){return i(t.k(a,e).filter(r).map(function(e){return t.k(e,n)}).reduce(function(e,t){return e*t},1))}},af_n:function(e,n,i,r){return void 0===r&&(r=function(e){return!0}),function(a){return i(function(e){return e&&e.length?e.map(function(e){return t.k(e,n)}).reduce(function(e,t){return Math.min(e,t)}):Number.POSITIVE_INFINITY}(t.k(a,e).filter(r)))}},af_x:function(e,n,i,r){return void 0===r&&(r=function(e){return!0}),function(a){return i(function(e){return e&&e.length?e.map(function(e){return t.k(e,n)}).reduce(function(e,t){return Math.max(e,t)}):Number.NEGATIVE_INFINITY}(t.k(a,e).filter(r)))}},af_m:function(e,n,i,r){return void 0===r&&(r=function(e){return!0}),function(a){return i(function(e){return e.map(function(e){return t.k(e,n)}).reduce(function(e,t){return e+t},0)/e.length}(t.k(a,e).filter(r)))}},af_u:function(e,n,i){return void 0===i&&(i=function(e){return!0}),function(r){return t.k(r,e).filter(i).map(n).reduce(function(e,t){return e||t},!1)}},af_i:function(e,n,i){return void 0===i&&(i=function(e){return!0}),function(r){return t.k(r,e).filter(i).map(n).reduce(function(e,t){return e&&t},!0)}},af_l:function(e,n,i){return void 0===i&&(i=function(e){return!0}),function(r){return n(t.k(r,e).filter(i).length)}},tp:function(e,n,i,r,a){var s=t.k(e.getSegments(),[n,i])||!1;return a&&(r||s)&&e.setThirdPartyActivation(n,i,a),s},sp:function(e,n,i,r,a){var s=t.k(e.getSegments(),[n,i])||!1;return a&&(r||s)&&e.setSegmentActivation(n,i,a),s},oe:function(e){for(var t=Object.keys(e),n=t.length,i=new Array(n);n--;)i[n]=[t[n],e[t[n]]];return i},lms:function(e,n,i){var r=e||{},a=n[i]||{},s=(a["1p"]||{}).const||0,o=t.oe(a);for(var c in o){var u=t.oe(o[c][1]);for(var l in u)!0===(r[o[c][0]]||{})[u[l][0]]&&(s+=u[l][1])}return function(e){return 1/(1+Math.pow(Math.E,-e))}(s)},fm:function(e,t){return{p:t.p,r:function(n,i){return e(t.r(n,i))},a:t.a}},cq:function(e,t,n){return{p:function(e,i){return[t.p(e,i),n.p(e,i)]},r:function(i,r){return e(t.r(i,r[0]),n.r(i,r[1]))},a:{z:[t.a.z,n.a.z],m:function(e,i){return[t.a.m(e[0],i[0]),n.a.m(e[1],i[1])]}}}},cw:function(e,n,i){return void 0===i&&(i=t.i),{a:{m:function(e,t){return e+t},z:0},p:function(i,r){return t.k(r,["name"])===e&&n(r)?1:0},r:function(e,t){return i(t)}}},mxw:function(e,n,i,r){void 0===r&&(r=t.i);var a=Number.NEGATIVE_INFINITY;return{a:{m:function(e,t){return e>t?e:t},z:a},p:function(r,s){return t.k(s,["name"])===e&&n(s)?t.k(s,i):a},r:function(e,t){return r(t)}}},vgw:function(e,n,i,r){void 0===r&&(r=t.i);var a={v:0,k:0};return{a:{m:function(e,t){var n=e.k+t.k;return{v:n?e.v+t.k*(t.v-e.v)/n:0,k:n}},z:a},p:function(r,s){return t.k(s,["name"])===e&&n(s)?{v:t.k(s,i),k:1}:a},r:function(e,t){return r(t.v)}}},mnw:function(e,n,i,r){void 0===r&&(r=t.i);var a=Number.POSITIVE_INFINITY;return{a:{m:function(e,t){return e<t?e:t},z:a},p:function(r,s){return t.k(s,["name"])===e&&n(s)?t.k(s,i):a},r:function(e,t){return r(t)}}},sw:function(e,n,i,r){void 0===r&&(r=t.i);return{a:{m:function(e,t){return e+t},z:0},p:function(r,a){return t.k(a,["name"])===e&&n(a)?t.k(a,i):0},r:function(e,t){return r(t)}}},pw:function(e,n,i,r){void 0===r&&(r=t.i);return{a:{m:function(e,t){return e*t},z:1},p:function(r,a){return t.k(a,["name"])===e&&n(a)?t.k(a,i):1},r:function(e,t){return r(t)}}},ctw:function(e,n,i,r){return{a:r?{m:function(e,t){return e.concat(t).slice(-r)},z:[]}:{m:function(e,t){return e.concat(t)},z:[]},p:function(r,a){return t.k(a,["name"])===e&&n(a)?t.k(a,i):[]},r:function(e,t){return t}}},ctv:function(n,i,r,a){function s(e,t){var n=function(e){return{k:e.k,c:1+e.c}},i={arr:[],add:{k:t,c:1}};return t?function(e){return e.arr.concat(e.add)}(e.reduce(function(e,t){return e.add.k===t.k?{arr:e.arr,add:n(t)}:{arr:e.arr.concat(t),add:e.add}},i)):e}return{a:a?{m:function(e,t){return s(e,t).slice(-a)},z:[]}:{m:function(e,t){return s(e,t)},z:[]},p:function(e,a){return t.k(a,["name"])===n&&i(a)?t.k(a,r):null},r:function(t,n){return n.reduce(function(t,n){var i;return e({},t,(i={},i[n.k]=n.c,i))},{})}}},ctu:function(e,n,i,r){return{a:r?{m:function(e,t){return e.filter(function(e){return!t.includes(e)}).concat(t).slice(-r)},z:[]}:{m:function(e,t){return e.filter(function(e){return!t.includes(e)}).concat(t)},z:[]},p:function(r,a){return t.k(a,["name"])===e&&n(a)?t.k(a,i):[]},r:function(e,t){return t}}},itp:function(e,n,i,r){return{a:{m:function(e,t){return t},z:!1},p:function(a,s){return t.tp(a,e,n,i,r)},r:function(e,t){return t}}},isp:function(e,n,i,r){return{a:{m:function(e,t){return t},z:!1},p:function(a,s){return t.sp(a,e,n,i,r)},r:function(e,t){return t}}},ifp:function(e){return{a:{m:function(e,t){return t},z:!1},p:function(n,i){return t.tp(n,"1p",e,!1)},r:function(e,t){return t}}},lm:function(e,n){return{a:{m:function(e,t){return t},z:[]},p:function(n,i){return[t.lms(n.getSegments(),n.getLookalikeModels(),e)]},r:function(e,t){return!!t[0]&&n(t[0])}}},sq:function(e){return{a:{m:function(t,n){return[n[0],e.a.m(null!=t[0]&&t[0][0]===n[0][0]?t[1]:e.a.z,n[1])]},z:[[],e.a.z]},p:function(n,i){return[[n.getCurrentSession()],t.k(i,["session_id"])===n.getCurrentSession()?e.p(n,i):e.a.z]},r:function(t,n){return e.r(t,n[0]!=[]&&n[0][0]===t.getCurrentSession()?n[1]:e.a.z)}}},vq:function(e){return{a:{m:function(t,n){return[n[0],e.a.m(null!=t[0]&&t[0][0]===n[0][0]?t[1]:e.a.z,n[1])]},z:[[],e.a.z]},p:function(n,i){return[[n.getCurrentView()],t.k(i,["view_id"])===n.getCurrentView()?e.p(n,i):e.a.z]},r:function(t,n){return e.r(t,n[0]!=[]&&n[0][0]===t.getCurrentView()?n[1]:e.a.z)}}},ltn:function(e,t){return{a:{m:function(e,n){return e.concat(n).slice(-t)},z:[]},p:function(t,n){return[e.p(t,n)]},r:function(t,n){return e.r(t,n.reduce(function(t,n){return e.a.m(t,n)},e.a.z))}}},ftn:function(e,t){return{a:{m:function(e,n){return e.concat(n.slice(0,t-e.length))},z:[]},p:function(t,n){return[e.p(t,n)]},r:function(t,n){return e.r(t,n.reduce(function(t,n){return e.a.m(t,n)},e.a.z))}}},tw:function(e,i){return{a:{m:function(t,i){return n.compose(e.a,t,i)},z:n.init({w:i})},p:function(r,a){return n.init({w:i,t:Math.max(t.kf(a,["time"],function(e){return e.getTime()}),r.getCurrentTime()),v:e.p(r,a)})},r:function(t,i){return e.r(t,n.query(e.a,i))}}},q:function(e){return{initial:function(t){return{result:e.a.z}},update:function(t,n,i){return{result:e.a.m(n.result,e.p(t,i))}},result:function(t,n){return{result:e.r(t,n.result)}},m:e.a.m,z:e.a.z,p:e.p,r:e.r}}},n={init:function(e){var t=e.t||Number.MIN_SAFE_INTEGER;return{w:e.w,t:t,in:void 0!==e.v?[[e.v,e.v,t]]:e.in||[],out:e.out||[]}},aIn:function(e,t){return t.in.length?t.in[t.in.length-1][1]:e.z},aOut:function(e,t){return t.out.length?t.out[t.out.length-1][1]:e.z},aOut_:function(e,t){return t.length?t[t.length-1][1]:e.z},query:function(e,t){return e.m(n.aOut(e,t),n.aIn(e,t))},enqueue:function(e,t,i,r){if(r<t.t)return t;var a=t.in.slice();return a.push([i,e.m(n.aIn(e,t),i),r]),n.init({w:t.w,t:r,in:a,out:t.out.slice()})},dequeue:function(e,t){var i=t.out.slice(),r=t.in.slice();if(!t.out.length)for(;r.length;){var a=r[r.length-1];i.push([a[0],e.m(a[0],n.aOut_(e,i)),a[2]]),r.pop()}return i.pop(),n.init({w:t.w,t:t.t,in:r,out:i})},minTime:function(e){return e.out.length?e.out[e.out.length-1][2]:e.in.length?e.in[0][2]:Number.MAX_SAFE_INTEGER},compose:function(e,t,i){if(i.t<t.t||t.w!==i.w)return t;for(var r=[],a=i.out.length-1;a>=0;--a)r.push([i.out[a][0],i.out[a][2]]);for(a=0;a<i.in.length;++a)r.push([i.in[a][0],i.in[a][2]]);for(var s=n.init({w:t.w,t:t.t,in:t.in.slice(),out:t.out.slice()}),a=0;a<r.length;++a)r[a][0]!==e.z&&(s=n.enqueue(e,s,r[a][0],r[a][1]));for(var o=i.t-i.w;n.minTime(s)<=o;)s=n.dequeue(e,s);return s}},i={10895:t.q(t.cw("Pageview",t.t,t.ge(1))),10937:t.q(t.cw("Pageview",t.ps(["client","domain"],"xobbaviwzxm"),t.ge(1))),10938:t.q(t.cw("Pageview",t.ps(["client","domain"],"prscfidwegm"),t.ge(1))),10939:t.q(t.cw("Pageview",t.ps(["client","domain"],"ndcbfnwlckr"),t.ge(1))),10989:t.q(t.cw("Pageview",t.pe(["geo_info","country"],"United Kingdom"),t.ge(1))),10990:t.q(t.itp("eyeota_bombora","14299",!1,"10990")),10991:t.q(t.itp("eyeota_bombora","14300",!1,"10991")),10992:t.q(t.itp("eyeota_bombora","14280",!1,"10992")),10993:t.q(t.itp("eyeota_bombora","14281",!1,"10993")),10994:t.q(t.itp("eyeota_bombora","14282",!1,"10994")),10995:t.q(t.itp("eyeota_bombora","14283",!1,"10995")),10996:t.q(t.itp("eyeota_bombora","14284",!1,"10996")),10997:t.q(t.itp("eyeota_bombora","14285",!1,"10997")),10998:t.q(t.itp("eyeota_bombora","14288",!1,"10998")),10999:t.q(t.itp("eyeota_bombora","14290",!1,"10999")),11000:t.q(t.itp("eyeota_bombora","14287",!1,"11000")),11001:t.q(t.itp("eyeota_bombora","14307",!1,"11001")),11002:t.q(t.itp("eyeota_bombora","14303",!1,"11002")),11003:t.q(t.cq(t.o0,t.itp("eyeota_bombora","14305",!1,"11003"),t.itp("eyeota_bombora","14306",!1,"11003"))),11004:t.q(t.itp("eyeota_bombora","14301",!1,"11004")),11005:t.q(t.cq(t.o0,t.itp("eyeota_bombora","14302",!1,"11005"),t.itp("eyeota_bombora","14304",!1,"11005"))),11006:t.q(t.itp("eyeota_bombora","14292",!1,"11006")),11007:t.q(t.itp("eyeota_bombora","14293",!1,"11007")),11008:t.q(t.itp("eyeota_bombora","14294",!1,"11008")),11009:t.q(t.itp("eyeota_bombora","14295",!1,"11009")),11010:t.q(t.itp("eyeota_bombora","14296",!1,"11010")),11011:t.q(t.itp("eyeota_bombora","14297",!1,"11011")),11012:t.q(t.itp("eyeota_bombora","14298",!1,"11012")),11429:t.q(t.cw("SocialShare",t.pe(["type"],"facebook"),t.ge(1))),11430:t.q(t.cw("SocialShare",t.pe(["type"],"twitter"),t.ge(1))),11431:t.q(t.cw("SocialShare",t.pe(["type"],"message"),t.ge(1))),11432:t.q(t.cw("SocialShare",t.pe(["type"],"anchor"),t.ge(1))),11591:t.q(t.sq(t.cw("Pageview",t.ps(["client","url"],"utm_source=fb1847"),t.ge(1)))),11592:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["betting","gambling","gamble","bet","oddsbible","tip","racing","odds"]),t.ge(1))),11595:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["beer","cider","cocktail","rum","smirnoff","vodka","gin","strongbow","rekorderlig","wetherspoon","guinness","malibu","budweiser","gordons","wine","coors"]),t.ge(1))),11596:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["rugby","football","sport","cricket","F1","formula1","formulaone","hockey","boxing","ufc","wrestling","wwe","wrestler","nfl","athletics","racing","tennis"]),t.ge(1))),11597:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["rugby","all-blacks","wallabies","six-nations","pro-14","heineken-cup"]),t.ge(1))),11598:t.q(t.cw("Pageview",t.ps(["client","url"],"football"),t.ge(1))),11600:t.q(t.cw("Pageview",t.ps(["client","url"],"football"),t.ge(2))),11601:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["boxing","ufc","wwe","wrestling","wrestler"]),t.ge(1))),11604:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["formula-1","formula-e","motor","super-car","vintage-car","car","classic-car","sports-car","drive","driving","f1"]),t.ge(1))),11605:t.q(t.cw("Pageview",t.ps(["client","url"],"cricket"),t.ge(1))),11606:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["tennis","wimbledon","roland-garros","us-open","australian-open","andy-murray","roger-federer","nadal","Serena-Williams","novac"]),t.ge(1))),11607:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["nfl","american-football","madden","patriots","super-bowl","blood-bowl"]),t.ge(1))),11609:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["hockey","ice-hockey"]),t.ge(1))),11610:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["tesco","sainsburys","asda","morrisons","george","m&s","marks-and-spencer","aldi","lidl","walmart","iceland","boots","primark","waitrose","river-island","new-look","asos","amazon","superdrug","supermarket","boohoo","sure","lynx","poundland"]),t.ge(1))),11611:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["health","diet","fitness","nutrition","muscle","weight-loss","tone","nhs","gym","active","motivation","calories","athlete","athletic","lifestyle","gains","protein","marathon","physical","well-being","wellbeing"]),t.ge(1))),11616:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["vegan","seitanist","meat-free","seitan","black-cat","copita"]),t.ge(1))),11617:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["vegetarian","vege","meat-free","animal-welfare","animal-cruelty","extinct"]),t.ge(1))),11618:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["food","tasty","burger","pizza","chocolate","calorie","mcdonalds","chicken","food-challenge","ice-cream","cake"]),t.ge(1))),11619:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["fashion","trend","clothing","clothes","asos","style","t-shirt","primark","hm","dress","jewellery","nails","zara","shoes","heels","designer","stylish","figure","suit","wear"]),t.ge(1))),11620:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["makeup","make-up","cosmetics","benefit","mac","beauty","lip","face-mask","urban-decay","hair","foundation","transform","nails","eye","superdrug","princess","body","sephora","contour","highlight"]),t.ge(1))),11621:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["celebrity","actor","comedian","kim-k","rapper","star","famous","youtuber","player","footballer","music"]),t.ge(1))),11626:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["kim-k","made-in-chelsea","towie","geordie-shore","kardashian","jenner","love-island","sotf","survival-of-the-fittest","x-factor","rupaul","voice","talent","big-brother","housewives","gogglebox"]),t.ge(1))),11627:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["music","drake","rapper","singer","grime","kanye","beyonce","rock","hiphop","hip-hop","rnb","song","pop-","tune","radio-1"]),t.ge(1))),11631:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["feminism","sexism","sexist","cat-calling","hate","charity","sanitary","tone","gender","vegan"]),t.ge(1))),11632:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["deal","saving","promo","bargain","buy-one","bogof","money","topcashback","quidco","wowcher","groupon","uk-deals"]),t.ge(1))),11633:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["film","tv","netflix"]),t.ge(1))),11638:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["action","tom-cruise","the-rock","cavill","hardy","wahlberg","vikander","statham","damon","reeves","crews","elba","butler","headey","jones","ridley","saldana","gadot","margot-robbie","Baccarin","mamoa"]),t.ge(1))),11649:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["comedy","kevin-hart","ferrell","the-rock","stiller","atkinson","pegg","frost","myers","hangover","fey","snl","ellen","rebel-wilson","reynolds","deadpool","kunis","rudd","segel","johnny-english"]),t.ge(1))),11650:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["incredibles","disney","wreck-it-ralph","moana","rick-and-morty","archer","witcher","simpsons","futurama","disenchantment","despicable-me","gru","how-to-train-your-dragon","kung-fu-panda","big-hero-6"]),t.ge(1))),11651:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["superhero","marvel","dc","batman","superman","iron-man","captain-america","avengers","justice-league","aquaman","cyborg","suicide-squad","arrow","cw","flash","wonder-woman","spiderman","thor","hulk","supergirl","panther","xmen","joker","x-men"]),t.ge(1))),11652:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["horror","thriller","paranormal","ghost","slasher","ahs","american-horror-story","saw","pennywise","scary","conjuring","insidious","scream","haunted","haunt","halloween","clown","vampire","zombie","polterguist"]),t.ge(1))),11653:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["romance","rom-com","romantic","bride","husband","love","boyfriend","girlfriend","wife","groom","briget-jones","love-actually","40-year-old-virgin","ben-affleck","colin-farrell","jude-law","ryan-gosling"]),t.ge(1))),11668:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["sci-fi","scifi","alien","ufo","science","space","star-wars","star-trek","zombie","apocalpse","disaster","transformers","shyamalan"]),t.ge(1))),11680:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["disney","pixar","nemo","aladdin","incredibles","moana","frozen","wreck-it-ralph","lion-king","dory","monsters-inc","toy-story","fairytale","star-wars","stitch","mulan","mermaid","snow-white","cinderella","brave","elsa","dumbo","artemis","maleficent","avatar","peter-pan"]),t.ge(1))),11681:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["aquaman","justice-league","batman","superman","harry-potter","fantastic-beasts","dc","hobbit","lord-of-the-rings","i-am-legend","sherlock","superhero","wonder-woman","flash","shazam","joker","godzilla","pokemon","pennywise","clown","shaft","lego-movie","mowgli","jungle-book","suicide-squad","annabelle","conjuring"]),t.ge(1))),11682:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["sony","spiderman","spider-man","james-bond","007","men-in-black","mib","terminator","will-smith","smurf","creed","jump-street","creed","resident-evil","ghostbusters","bad-boys","tom-hanks","peter-rabbit","hancock"]),t.ge(1))),11684:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["netflix","amazon-prime","hulu","hayu","sabrina","disenchantment","haunting","narcos","house-of-cards","frontier","witcher","brooklyn-99","brooklyn-nine-nine","bird-box","peaky-blinders","riverdale","making-a-murderer","series-of-unfortunate-events","black-mirror","ozark","oitnb","orange-is-the-new-black","last-kingdom","staircase","last-chance-u","american-vandel","thirteen-reasons-why","13-reasons-why","the-ranch","dynasty","sense-8","black-lightening","big-mouth","alienist","better-call-saul","breaking-bad","stranger-things","tina-fey","punisher","rick-and-morty","master-of-none","innocent-man","keepers","dark-tourist","sinner","queer-eye","final-space"]),t.ge(1))),11686:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["gaming","play","fifa","twitch","youtube","fortnite","call-of-duty","cod","app","console","pc","pokemon","game","ps1","playstation-classic","playstation","xbox","nintendo","ps2","ps3","ps4","ps5"]),t.ge(1))),11687:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["console","playstation","ps1","ps2","ps3","ps4","ps5","xbox","nintendo-switch","sony","sega","uncharted","halo","fifa","gears-of-war","forza","infamous","red-dead","microsoft"]),t.ge(1))),11688:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["mobile","iOS","android","clash","candy-crush","angry-birds","pixel","samsung","pokemon-go","hay-day","contest-of-champions","galaxy-of-heroes","slots","injustice","augmented-reality","-ar-"]),t.ge(1))),11689:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["runescape","pc","computer","football-manager","world-of-warcraft","wow","pubg","alienware","laptop","league-of-legends","lol","steam","skyrim","twitch","gta","microsoft","minecraft","stream","grand-theft-auto"]),t.ge(1))),11690:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["-ea-","fifa","battlefield","nhl","madden","battlefront","sims","need-for-speed","ufc","nba","titanfall","dragon-age","dead-space","mass-effect"]),t.ge(1))),11691:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["bethesda","fallout","fall-out","skyrim","elder-scrolls","doom","wolfenstein","dishonoured","rage","quake","irha"]),t.ge(1))),11692:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["cod","call-of-duty","activision","destiny","guitar-hero","spyro","angry-birds","ice-age","007","james-bond","quake","star-wars","simpsons","tony-hawk","transformers","skylanders","shrek","indiana-jones","how-to-train-your-dragon"]),t.ge(1))),11693:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["assassins-creed","ubisoft","far-cry","farcry","tom-clancy","watchdog","the-crew","just-dance","monopoly","watch-dog","creed","assassin","for-honour","mario","rayman"]),t.ge(1))),11694:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["fifa","pro-evo","pes","football-manager","goals","penalty","skill","ultimate-team","career-mode","division-rivals","ksi","copa-90","twitch","calfreezy","mgh"]),t.ge(1))),11696:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["call-of-duty","cod","battlefield","tom-clancy","-war-"]),t.ge(1))),11697:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["fortnite","pubg","team-fortress","overwatch"]),t.ge(1))),11698:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["gta","grand-theft-auto"]),t.ge(1))),11699:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["minecraft","stream","builder","tetris","twitch","youtube"]),t.ge(1))),11700:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["uokm8","extinct","free-to-be","freetobe","rnli","cancer-research","trash-isles","charity","government","body-sham","empower","femis","sexis","racis","lgbt","cause","illegal","environment","politic","ocean","mental-health","change"]),t.ge(1))),11701:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["technology","tech","science","innovation","innovate","phone","iphone","samsung","android","microsoft","car","invent"]),t.ge(1))),11710:t.q(t.tw(t.cw("Pageview",t.t,t.ge(10)),2592e6)),11722:t.q(t.cw("VideoAdProgress",t.pge(["progress"],1),t.ge(1))),11793:t.q(t.cq(t.o0,t.tw(t.cw("Pageview",t.pg(["article","wordCount"],500),t.ge(4)),24192e5),t.tw(t.cw("PageviewEngagement",t.pe(["completion"],.75),t.ge(4)),24192e5))),11799:t.q(t.tw(t.cw("Pageview",t.os(t.e,["article","rating"],["rating-u","rating-pg"]),t.ge(4)),24192e5)),11805:t.q(t.cw("Pageview",t.pe(["isp_info","autonomous_system_organization"],"British Telecommunications PLC"),t.ge(1))),11806:t.q(t.cw("Pageview",t.pe(["isp_info","autonomous_system_organization"],"Virgin Media Limited"),t.ge(1))),11807:t.q(t.cw("Pageview",t.pe(["isp_info","autonomous_system_organization"],"Sky UK Limited"),t.ge(1))),11808:t.q(t.cw("Pageview",t.pe(["isp_info","autonomous_system_organization"],"TalkTalk"),t.ge(1))),11809:t.q(t.cw("Pageview",t.ps(["client","referrer"],"facebook"),t.ge(1))),11811:t.q(t.cw("Pageview",t.ps(["client","referrer"],"insta"),t.ge(1))),11812:t.q(t.cw("Pageview",t.ps(["client","referrer"],"twitter"),t.ge(1))),11813:t.q(t.cq(t.o0,t.tw(t.cw("PageviewEngagement",t.a(t.pe(["total_completion"],.75),t.pe(["client","domain"],"www.ladbible.com")),t.ge(4)),2592e6),t.tw(t.cw("Pageview",t.a(t.pge(["article","wordCount"],500),t.pe(["client","domain"],"www.ladbible.com")),t.ge(4)),2592e6))),11814:t.q(t.cq(t.o0,t.tw(t.cw("PageviewEngagement",t.a(t.pe(["total_completion"],.75),t.pe(["client","domain"],"www.sportbible.com")),t.ge(4)),2592e6),t.tw(t.cw("Pageview",t.a(t.pge(["article","wordCount"],500),t.pe(["client","domain"],"www.sportbible.com")),t.ge(4)),2592e6))),11815:t.q(t.cq(t.o0,t.tw(t.cw("PageviewEngagement",t.a(t.pge(["total_completion"],.75),t.pe(["client","domain"],"www.pretty52.com")),t.ge(4)),2592e6),t.tw(t.cw("PageviewEngagement",t.a(t.pge(["article","wordCount"],300),t.pe(["client","domain"],"www.pretty52.com")),t.ge(4)),2592e6))),11816:t.q(t.tw(t.cw("Pageview",t.pe(["client","domain"],"www.ladbible.com"),t.ge(10)),2592e6)),11817:t.q(t.tw(t.cw("Pageview",t.pe(["client","domain"],"www.sportbible.com"),t.ge(10)),2592e6)),11819:t.q(t.tw(t.cw("Pageview",t.pe(["client","domain"],"www.pretty52.com"),t.ge(5)),2592e6)),11870:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["travel","flying","flight","airport","ryanair","easyjet","-BA-","british-airways","emirates","hikes","adventure","holiday","summer","ski","travelling","beach","tourist","weekend-break","getaway","excursion","mountain","city-break"]),t.ge(1))),11879:t.q(t.cw("Pageview",t.pe(["client","type"],"fia"),t.ge(1))),11923:t.q(t.tw(t.cw("Pageview",t.pe(["client","domain"],"www.unilad.co.uk"),t.ge(10)),2592e6)),11944:t.q(t.cw("Pageview",t.ps(["client","referrer"],"snapchat"),t.ge(1))),12002:t.q(t.cw("Pageview",t.a(t.pe(["client","type"],"fia"),t.pe(["client","domain"],"www.ladbible.com")),t.ge(1))),12003:t.q(t.cw("Pageview",t.a(t.pe(["client","type"],"fia"),t.pe(["client","domain"],"www.sportbible.com")),t.ge(1))),12004:t.q(t.cw("Pageview",t.a(t.pe(["client","type"],"fia"),t.pe(["client","domain"],"www.pretty52.com")),t.ge(1))),12023:t.q(t.cw("SlotClicked",t.os(t.e,["campaign_id"],[2436406791,2436144361,2436152293]),t.ge(1))),12042:t.q(t.cw("SlotClicked",t.t,t.ge(1))),12045:t.q(t.sq(t.cw("PageviewEngagement",t.pe(["client","type"],"fia"),t.ge(18)))),12046:t.q(t.sq(t.cw("PageviewEngagement",t.a(t.pe(["client","type"],"fia"),t.ps(["client","url"],"ladbible")),t.ge(18)))),12047:t.q(t.sq(t.cw("PageviewEngagement",t.a(t.pe(["client","type"],"fia"),t.ps(["client","url"],"sportbible")),t.ge(18)))),12048:t.q(t.sq(t.cw("PageviewEngagement",t.a(t.pe(["client","type"],"fia"),t.ps(["client","url"],"pretty52")),t.ge(18)))),12190:t.q(t.sq(t.cw("PageviewEngagement",t.a(t.pe(["client","type"],"fia"),t.ps(["client","url"],"unilad")),t.ge(18)))),12195:t.q(t.cq(t.o0,t.lm("f541acf7-64d7-469f-bf0e-9bf3f6d0c93b",t.ge(.91730464)),t.ifp("11722"))),12456:t.q(t.sq(t.cw("Pageview",t.pn(["client","type"],"fia"),t.ge(1)))),12478:t.q(t.tw(t.cw("Pageview",t.ps(["client","url"],"utm_source=fb1847"),t.ge(1)),2592e6)),12753:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["xbox","microsoft","halo","forza","madden"]),t.ge(1))),12977:t.q(t.cw("Pageview",t.ps(["client","url"],"mental-health"),t.ge(1))),13058:t.q(t.cw("Pageview",t.pe(["client","domain"],"www.ladbible.com"),t.ge(1))),13079:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["baby","babies","toddler","kids"]),t.ge(1))),13432:t.q(t.cw("SlotClicked",t.pe(["campaign_id"],2504516142),t.ge(1))),13439:t.q(t.cq(t.o0,t.cw("SlotClicked",t.pe(["campaign_id"],2503771367),t.ge(1)),t.cw("Pageview",t.os(t.e,["client","url"],["http://www.sportbible.com/horse-racing/betting-cheltenham-betting-preview-day-two-ladies-day-20190312?source=twitter","http://www.sportbible.com/horse-racing/betting-cheltenham-betting-preview-day-one-champion-day-20190311?c=1552344915663","http://www.sportbible.com/horse-racing/betting-cheltenham-betting-preview-day-three-st-patricks-thursday-20190314?c=1552554831863"]),t.ge(1)))),13538:t.q(t.cw("SlotClicked",t.pe(["campaign_id"],2495141883),t.ge(1))),13697:t.q(t.cw("Pageview",t.a(t.ps(["client","url"],"https://www.unilad.co.uk/"),t.pe(["client","type"],"fia")),t.ge(1))),13782:t.q(t.itp("eyeota_experian","27994",!1,"13782")),13799:t.q(t.itp("eyeota_experian","30509",!1,"13799")),13808:t.q(t.cw("Pageview",t.o(t.os(t.s,["isp_info","organization"],["University","College","School"]),t.os(t.e,["geo_info","postal_code"],["CV1","CB2","OX1","KY16","LE11","DH1","BA2","SW7","CV4","LA1","LS2","WC1E","YO10","EX4","WC2A","NG7","NG11","NR4","B15","GU2","LN6","SO17","G12","PO1","BN1","NE1","EH8","DE22","DD1","SA2","CO4","L16","M13","CT2","ST5","BS16","TW20","S10","FK9","OX3","HD1","B4","ST4","RG6","LL57","L3","AB24","BT7","G1","PO22","GL50","L39","L3"])),t.ge(1))),13809:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["dad","father","mum","mom","mama","mother","kid","child","granddad","grandma","son","daugther","niece","nephew","gran"]),t.ge(1))),13810:t.q(t.cw("Pageview",t.ps(["isp_info","isp"],"Vodafone"),t.ge(1))),13883:t.q(t.cq(t.o0,t.lm("ae17eb69-789c-4fcb-a31b-d662893027b4",t.ge(.8177995)),t.ifp("13808"))),14078:t.q(t.cq(t.a0,t.tw(t.cw("Pageview",t.t,t.ge(1)),2592e6),t.itp("eyeota_bombora","13902",!1,"14078"))),14101:t.q(t.cw("PollResponse",t.a(t.a(t.pe(["answer","text"],"Adidas"),t.pe(["survey","id"],"e7eee8e0-3f7d-45bf-bd43-8a1bc5c8f870")),t.pe(["question","id"],"6c8fa360-62e3-4884-9358-9022c1d1ce6d")),t.ge(1))),14111:t.q(t.cq(t.a0,t.cq(t.a0,t.cw("Pageview",t.t,t.ge(1)),t.itp("eyeota_experian","27481",!1,"14111")),t.cq(t.o0,t.cq(t.o0,t.itp("eyeota_bombora","14280",!1,"14111"),t.itp("eyeota_experian","30136",!1,"14111")),t.itp("eyeota_experian","16679",!1,"14111")))),14149:t.q(t.cw("SlotClicked",t.pe(["campaign_id"],4978203241),t.ge(1))),14277:t.q(t.cw("Pageview",t.os(t.s,["client","url"],["bmx","fast-and-furious","fast-&-furious","Arenacross","masters-of-dirt","red-bull","soapbox","tony-hawk","travis-pastrana","Nitro-world","Nitro-circus","jackass","monster-energy","ryan-williams","elliot-sloan","colton-walker","levi-sherwood","harry-binks","vans","element","festival-of-power","dirty-sanchez","fighters","supercross","motor-gp","steve-o","fox-racing","racing"]),t.ge(1)))};return void 0!==i?i:{}}(),n={10895:["0c8b70cdb7","Everyone",["s"],"58b12b4e-3cc7-4f31-b007-f3d93c4f2c46"],10937:["29673e497b","Turbine-Test-1",["s"],"9117ff88-da4d-4aab-8250-7d037c16c890"],10938:["a17100c177","Tubine-Test-2",["s"],"2c71cf26-d642-4226-8296-aed2a564350a"],10939:["8fffbac781","Turbine-Test-3",["s"],"64b087f4-d213-4e8e-b00f-ff240608cf75"],10989:["22911a2329","UK Visitors",["s"],"46e46142-5c12-4dae-bbce-e1b9efc1d857"],10990:["dbfd4af443","Permutive Analytics: Female",["s"],"e2211e89-b85b-430c-9685-4e4f07a9b6e3"],10991:["d1d3ec9923","Permutive Analytics: Male",["s"],"28fff52d-f483-49c1-85b7-e42432b679a6"],10992:["e49bf4287b","Permutive Analytics: 18-24",["s"],"b79c0eb3-8451-4b81-ade9-a544131fc7e4"],10993:["d703dec85d","Permutive Analytics: 25-34",["s"],"b152196d-b4a9-4e8b-8a47-dad3e44ed24b"],10994:["61bdca09cc","Permutive Analytics: 35-44",["s"],"7b4f58df-d90c-4429-be2b-691a87fc4c4a"],10995:["ed8533b534","Permutive Analytics: 45-54",["s"],"9b725ba1-53a4-40ea-874f-307f81ce91c9"],10996:["58ee78a619","Permutive Analytics: 55-64",["s"],"d06a2063-075a-4053-86e4-ed1df090732d"],10997:["db0226bc59","Permutive Analytics: 65+",["s"],"0b056519-5fe0-4f28-85c9-a389750e0093"],10998:["5b3505d584","Permutive Analytics: High School",["s"],"0720ace4-4b9e-4163-b6b9-e72efc378eca"],10999:["5eed0b88ab","Permutive Analytics: University",["s"],"189a8208-21b0-40c3-927d-91539bcde7c9"],11000:["0f0ee5e442","Permutive Analytics: Post-Grad",["s"],"fb8ed164-c7f9-45bd-8499-b47ee395c780"],11001:["d6d01347bd","Permutive Analytics: HHI $0-25k",["s"],"bfaf56f6-44f6-425a-9b11-9ab9535559d3"],11002:["d0b5a13bd8","Permutive Analytics: HHI $25-50k",["s"],"f54f7997-3843-4313-a35a-65c2cbefaeab"],11003:["059894083e","Permutive Analytics: HHI $50-100k",["s"],"1b329ec7-ad66-463e-8df1-d1092289f215"],11004:["a566f1832c","Permutive Analytics: HHI $100-150k",["s"],"e33d3141-c621-434d-86ec-11a1256eeb49"],11005:["ab2cea03b2","Permutive Analytics: HHI $150k+",["s"],"dcc76835-b0f5-40b7-8362-28448abe5986"],11006:["196dd75e5e","Permutive Analytics: African American",["s"],"8e89521c-d953-44bd-a3f9-f2dddb627c1a"],11007:["94c20a8a61","Permutive Analytics: Asian",["s"],"71d1df3e-e3f9-4de6-968b-16fc2c6b289f"],11008:["8336fc57de","Permutive Analytics: European",["s"],"a8ee4cb4-ede0-450d-8ab0-6ff037f6a8cb"],11009:["d0ec4aeb27","Permutive Analytics: Hispanic",["s"],"6aa76b6b-0d71-4d1c-9438-8885c3787600"],11010:["b38827071b","Permutive Analytics: Indian",["s"],"d91ebc54-d8fe-4f16-8732-808022f44f66"],11011:["e6b7992382","Permutive Analytics: Middle Eastern",["s"],"51b61895-7272-49ec-b0ff-4ea1d157e705"],11012:["03d5d7a96d","Permutive Analytics: Native American",["s"],"66948b6d-65a9-429d-b079-7771f1f0a3eb"],11429:["9320650d0e","Social Shares - Facebook",["s"],"68190986-7a49-4242-bcc6-ceb300cc1d65"],11430:["e88afeb5f2","Social Shares - Twitter",["s"],"d7cda03c-2fdd-4863-ae02-f7bd081262a3"],11431:["2586cf1e8f","Social Shares - Comments",["s"],"a928fd9e-dcf0-4e47-84e3-1429b157c2b4"],11432:["e9bc1577f9","Social Shares - Anchor",["s"],"91aa7921-aca2-4d4f-b41d-2a7f4ed5a42e"],11591:["147a1b96dd","Turbine - Facebook Paid Referral ",["s"],"289e2b96-7208-4d09-89bb-a1cc50ad0f46"],11592:["550616c67d","All Sites | Betting | Betting & Gambling Content | Permutive",["s"],"bb299799-602b-44b5-837b-f4f941eb59c3"],11595:["2d8039b37a","All Sites | Alcohol | Beers, Ciders, Cocktails & Spirits | Permutive",["s"],"6ea959d3-8158-45b7-95dc-dda5ce7abd16"],11596:["d301f94692","All Sites | Sport | All Sports | Permutive",["s"],"35798676-f122-477f-8758-fb87dc6017db"],11597:["337b9c0ef4","All Sites | Rugby | International & Club Rugby | Permutive",["s"],"2840d65a-09b6-4d1a-820c-37bd86d57cde"],11598:["eeb91c1edf","All Sites | Football | Football Fans (1+ Sessions) | Permutive",["s"],"d961606f-8681-4b8a-bb19-e52e754a953f"],11600:["1d4ffaeb5a","All Sites | Football | Avid Football Fans (2+ Sessions) | Permutive",["s"],"27953b47-0617-4097-93e3-281b884650f2"],11601:["f24a23b4f3","All Sites | Boxing | Boxing, UFC & Wrestling | Permutive",["s"],"f272a8d5-8084-480a-a4d2-3a1c1f31f6e6"],11604:["d866435f5f","All Sites | F1 & Motors | Formula 1, Formula E, Vintage & Super-Cars  | Permutive",["s"],"3dd1e62f-9e55-49fb-b8ad-535764369bff"],11605:["785749a62c","All Sites | Cricket | International & Club Cricket | Permutive",["s"],"14caaff4-f837-44d2-9a3a-f4b23d21ab3a"],11606:["501c471e24","All Sites | Tennis | Professional Singles Tennis  | Permutive",["s"],"29f9010c-49f2-44ed-bbaf-4bc83c529c5a"],11607:["4b1e915b57","All Sites | NFL | American Football & Tournaments | Permutive",["s"],"371ea49a-2582-4957-a98e-455466c93507"],11609:["f6819f87fc","All Sites | Hockey | International & Club Hockey  | Permutive",["s"],"47f40086-f668-437a-a725-efc8dc9ddf65"],11610:["a99a0dd1d1","All Sites | FMCG |Supermarket & Drugstore Goods | Permutive",["s"],"30f6e9a4-5a65-4495-83fd-f772a599374c"],11611:["e019ebae84","All Sites | Health & Fitness | Fitness Trends | Permutive",["s"],"97f6a649-929e-461d-8717-a0c6b1ad33c7"],11616:["a6da25bddb","All Sites | Vegan | Vegan Food | Permutive",["s"],"fa3d6eed-7514-429f-b70d-3d13102a1899"],11617:["3bc7d9925c","All Sites | Vegetarian | Vegetarian Lifestyle | Permutive",["s"],"c51bb488-3d03-4fd2-83ee-1118d61f8ee4"],11618:["cc0dc0098f","All Sites | Food | Foodies & Foodophiles | Permutive",["s"],"d38a1d9e-d768-4899-b8a8-0e10bde1ba86"],11619:["9fa6831a3c","All Sites | Fashion | Men & Women's Fashion | Permutive",["s"],"04d37508-6a9c-42b1-ab34-01dcfe8b9a15"],11620:["9e71b7fea4","All Sites | Beauty | Makeup & Cosmetics | Permutive",["s"],"14ef0e46-8296-4cff-a53b-3fdee646fe3f"],11621:["9fb13455dd","All Sites | Celebrity | Actors, Reality TV Stars, Sport Personalities, Musicians & YouTubers | Permutive",["s"],"1dbc3c3d-3968-487c-9b18-acba4d912e58"],11626:["0a7c0ff091","All Sites | Celebrity | Reality TV Stars | Permutive",["s"],"e7e9ef4e-104b-48e8-93e1-31cc0019452e"],11627:["9ed037f6c0","All Sites | Celebrity | Musicians | Permutive",["s"],"52f3c6cc-4e07-4e0c-9c65-6ce20384c21a"],11631:["6805dbeba6","All Sites | Social Good | Female Orientated Social Change | Permutive",["s"],"61586537-55f2-44b5-9601-5f3520d376c3"],11632:["29b4ed06a9","All Sites | Finance | Deals & Savings | Permutive",["s"],"52ea3f3f-392b-4986-aa08-dc679e508ab8"],11633:["055488b35e","All Sites | Film | All Film & TV | Permutive",["s"],"0a45b480-afad-4931-b2a3-132e3e6b6abc"],11638:["056f1588d8","All Sites | Film | Action | Permutive",["s"],"3b03ccdf-fd05-4702-a0dc-ecb261b40d26"],11649:["5de85d8f8d","All Sites | Film | Comedy | Permutive",["s"],"ae463c97-23c4-4c1e-a1c3-91947025e233"],11650:["0d0e9f95fe","All Sites | Film | Animation | Permutive",["s"],"893e5d86-fdb7-4648-b7ae-25dbb5204c77"],11651:["08b17848d0","All Sites | Film | Superhero | Permutive",["s"],"756b53f5-20a9-4ff8-a2dc-5c753a04510c"],11652:["69bade9673","All Sites | Film | Horror | Permutive",["s"],"1224b383-7646-4aeb-89fc-3c0dc3190a8b"],11653:["f70b4e011f","All Sites | Film | Romantic | Permutive",["s"],"2670eb06-9844-4ec5-9426-ece667534465"],11668:["91884e416a","All Sites | Film | Sci-Fi | Permutive",["s"],"e72b6a7b-22eb-4ade-ad77-b4a13585653f"],11680:["2c07d0998f","All Sites | Film | Disney-Pixar | Permutive",["s"],"949dd664-c164-4779-95d9-270d60d4946e"],11681:["9d1aaba60f","All Sites | Film | Warner Bros | Permutive",["s"],"6cc61c2a-86b4-469a-a726-6b43f1d89d08"],11682:["2d9393fc5b","All Sites | Film | Sony Pics | Permutive",["s"],"d07c28e7-fe18-485b-a28b-63e1674c4560"],11684:["ddffbf42ff","All Sites | Steaming | Netflix  & Others | Permutive",["s"],"7427cc76-7501-4b04-9263-9a95dc908bad"],11686:["9fe618da5c","All Sites | Gaming | All Gaming | Permutive",["s"],"dcce1243-1847-4ff3-a3c5-18a65fd0fd76"],11687:["87562e9965","All Sites | Gaming | Console Gaming | Permutive",["s"],"b72d7efa-0679-48a6-9b46-9fa6f7e3825b"],11688:["4e9d758dc7","All Sites | Gaming | Mobile Gaming | Permutive",["s"],"663a52ce-96de-489e-b073-b0f7e8e8d0ab"],11689:["bf28251a01","All Sites | Gaming | PC Gaming | Permutive",["s"],"ad184681-c6f8-4f66-9367-ad9e538e21af"],11690:["3cb15e340c","All Sites | Gaming | EA | Permutive",["s"],"930ba477-521d-45d0-b359-ecc35e27bc37"],11691:["4380436eb8","All Sites | Gaming | Bethesda | Permutive",["s"],"e9d840ba-d842-4efb-b1fd-3613a6b4b18b"],11692:["d82981ff9e","All Sites | Gaming | Activision | Permutive",["s"],"1a1d8c29-6181-4702-bb11-8834e52e6211"],11693:["8a6b112636","All Sites | Gaming | Ubisoft | Permutive",["s"],"50acb397-0ecc-4db4-aebb-4f2cce573189"],11694:["b9ac08badb","All Sites | Gaming | Fifa | Permutive",["s"],"e4c7fc41-1998-4367-b76a-3e4e2edf2891"],11696:["b741e58cf2","All Sites | Gaming | Call of Duty | Permutive",["s"],"dcbc0146-55ad-45d3-9928-af9201a5e6e9"],11697:["46c72ac027","All Sites | Gaming | Fortnite | Permutive",["s"],"731e3444-f324-43a6-9f0a-0fbfbc5a5c77"],11698:["4bf40cedad","All Sites | Gaming | GTA | Permutive",["s"],"18a49acb-2517-4f32-849c-a163e5301cd2"],11699:["c5603d307a","All Sites | Gaming | Minecraft | Permutive",["s"],"a10eeb02-cb84-42df-8a33-04afdb325c9b"],11700:["47b9413637","All Sites | Government & Charity | Social Cause & Behavioural Change Campaigns | Permutive",["s"],"abfde0db-e2e4-43d8-916d-271ba13de018"],11701:["8ce2fdf1c6","All Sites | Tech | Gadgets, Innovations & Science | Permutive",["s"],"aa701613-5623-4a41-9143-fa547f0dd575"],11710:["6e98532ec3","All Sites | Repeat Visitors | 10+ Sessions | Permutive",["s"],"b0a27e5f-00b0-47b1-964d-75b4dc19ac30"],11722:["9e8d14e501","All Sites | Video | Completion Rate Booster | Permutive",["s"],"3b8003dd-d82a-4f28-81b0-bdb1b8ad5aed"],11793:["34a84892c1","All Sites | Engagers | 75%+ Scroll Depth / Affinity With Long Form Content | Permutive",["s"],"8272c6b1-403c-4ca4-aabd-94478b2a3c11"],11799:["1ed6aac7de","All Sites | Brand Safety | Ultra-Safe Content | Permutive",["s"],"6697385d-f4c1-423c-bdf3-371f381fb637"],11805:["8ca8ff47c8","All Sites | Broadband | BT | Permutive",["s"],"b290b97a-8707-445c-b9f6-332547638182"],11806:["28100023a4","All Sites | Broadband | Virgin Media | Permutive",["s"],"efed09fd-747e-41a2-80cf-163f3693a7ab"],11807:["c5d88987b2","All Sites | Broadband | Sky | Permutive",["s"],"1379fc30-223d-4193-96f5-fa21fa0b05f1"],11808:["12143e273d","All Sites | Broadband | Talk Talk | Permutive",["s"],"d582dd77-f289-4267-9e0a-992bb6eeb654"],11809:["bdda588eff","All Sites | Referral | Facebook | Permutive",["s"],"f4a18812-b6cd-4628-8b6d-b7debc72937e"],11811:["5e9a276920","All Sites | Referral | Instagram | Permutive",["s"],"2b4534f6-488f-4812-9e0f-ef2565ab089b"],11812:["54b4bfaaa0","All Sites | Referral | Twitter | Permutive",["s"],"9e55869f-3fa7-48ca-a8d6-d331fa8fe318"],11813:["a7b8051928","LAD | Engagers | 75%+ Scroll Depth / Affinity With Long Form Content | Permutive",["s"],"1e4003fe-6150-41a1-9711-a50200f1d142"],11814:["601297c831","SPORT | Engagers | 75%+ Scroll Depth / Affinity With Long Form Content | Permutive",["s"],"565df7b5-2b71-4849-9c03-0c6b16fadd46"],11815:["90b32eba9d","Pretty52 | Engagers | 75%+ Scroll Depth / Affinity With Long Form Content | Permutive",["s"],"4e3825e3-cb50-4675-849d-c0ea8a3f30b7"],11816:["64ce821287","LAD | Repeat Visitors | 10+ Sessions | Permutive",["s"],"ab3f5416-cae4-4a63-ae59-64f67043a470"],11817:["593a9815ae","SPORT | Repeat Visitors | 10+ Sessions | Permutive",["s"],"ebf09385-94ee-4d65-b7e0-6de64222208e"],11819:["33150fd560","Pretty52 | Repeat Visitors | 5+ Sessions | Permutive",["s"],"4535aa95-4877-4d14-a742-9c09f586bc27"],11870:["3880083eba","All Sites | Travel | Adventures & Holidays Abroad | Permutive",["s"],"f1d37985-f959-436d-82de-711f2e23748e"],11879:["15e2aaaa1b","Instant Articles - Yes",["s"],"bf23d786-7c2a-4107-868c-5a78d9116aee"],11923:["f8cb70c8c5","UNILAD | Repeat Visitors | 10+ Sessions | Permutive",["s"],"0d0ba5af-ddc9-4f64-8326-d25145e76f62"],11944:["790b5b188f","All Sites | Referral | Snapchat | Permutive",["s"],"986b3314-b528-403c-bae6-13285eee6b6d"],12002:["ccb9e6bf4e","Instant Articles - LADbible",["s"],"2a6780d4-9d1f-4887-88eb-cf1f2bf9c4b2"],12003:["4d40ac9f28","Instant Articles - SPORTbible",["s"],"25a47f18-66ee-4866-b04d-8e9fcd13322d"],12004:["57a80d9845","Instant Articles - Pretty52",["s"],"cd62fb34-f30b-4b08-9831-8b8004c90ebf"],12023:["647be0072d","All Sites | Puig | Millions, Invictus & Pure XS | Permutive",["s"],"dc30ad0b-1103-4261-9f46-694d6499b938"],12042:["d2f664deef","All Sites | Clickers | Click Booster | Permutive",["s"],"146cf712-0b2a-40e5-90cd-b078cc89baad"],12045:["da904c6914","All Sites | Engagers | Instant Article Engagement | Permutive",["s"],"30719325-ef9c-4bb6-83b4-1b6378b2d355"],12046:["8721d5e1e0","LAD | Engagers | Instant Article Engagement | Permutive",["s"],"de8e981a-4b87-454a-ae55-761361bfdf13"],12047:["4f710f9305","SPORT | Engagers | Instant Article Engagement | Permutive",["s"],"cac80e2e-2d56-44d4-a016-69dc9e1e6087"],12048:["f200a38449","Pretty52 | Engagers | Instant Article Engagement | Permutive",["s"],"b249bb5e-3896-4a91-9d12-80f6c3c1bcfc"],12190:["6727ff0f2e","UNILAD | Engagers | Instant Article Engagement | Permutive",["s"],"434efeb1-73d6-4be2-8d73-1b6df2f182de"],12195:["68cd4228b5","All Sites | Video | Completion Rate Booster | Permutive Lookalike: 91.7%",["l","s"],"39875af2-b396-4d9d-8fe6-3e012d4a6a15"],12456:["27b31d48d7","LADbible | None IA Video",["s"],"d854e71d-0e75-41fc-8710-ff7a9c193240"],12478:["98f8b5eedd","TEST Turbine - Facebook Paid Referral 30 days",["s"],"36e9de97-cca5-41e0-b71d-717f04deccdb"],12753:["5e89bfb638","All Sites | Gaming | Xbox Users | Permutive",["s"],"8532b360-5138-4089-bff9-f11fd616cf3c"],12977:["6bc15b62d7","LADbible | UOKM8? | Permutive",["s"],"972ff41c-1949-4953-88bd-1eb8b443d985"],13058:["7e2639294c","LADbible - New User (Audience Extension)",["s"],"e81065d3-643a-4453-90bd-ff9b489febcc"],13079:["6469d98496","All Sites | Community | Baby-Engaged | Permutive",["s"],"a0b6852d-3a35-4077-9a37-c98e8090fcff"],13432:["54ebd9d455","All Sites | Bet365 | Cheltenham Takeover 2019 | Permutive",["s"],"97f4c72f-ffd0-4de3-aaeb-9a5c82cd17ee"],13439:["81f8f36491","All Sites | Betway | Cheltenham Takeover 2019 | Permutive",["s"],"c3186bb9-e1c4-4df3-b122-bd28c35d4715"],13538:["3cc0703957","All Sites | Playstation | PS Plus Brand Refresh | Permutive",["s"],"ab353865-a91d-4efa-b79a-bc2b7a72814f"],13697:["146b4bd897","IA - UNILAD TEST",["s"],"c7449ac4-120c-4d70-bfb6-9d6ccf4651b7"],13782:["015cd017db","All Sites | Parenting | Third Party (+2 CPM ) | Permutive",["s"],"106fa8ca-cee5-491c-8818-34c4bfa0eec9"],13799:["533a374210","All Sites | Students | Third Party (+2 CPM) | Permutive",["s"],"9000b14c-6a9c-468b-837f-a454fa25bbeb"],13808:["ea69498f2b","All Sites | Students | University, College or School | Permutive",["s"],"72b2a64f-fe79-46b9-830e-c971c7d42ed8"],13809:["11bf9dd400","All Sites | Parenting | Family Related Content | Permutive",["s"],"e6369ddd-b8b7-418e-977d-3acf63b0222b"],13810:["3d860cdcf8","All Sites | Vodafone | Mobile Network | Permutive",["s"],"abd22816-75b3-4075-969d-c17e4a4a9716"],13883:["a37117d051","All Sites | Students | University, College or School | Lookalike 81% | Permutive",["l","s"],"35a0be68-373d-40ab-be18-78e5e1347cbf"],14078:["1e7fc6740f","IT Decision Makers (3rd Party)",["s"],"82217f07-5862-4829-a7f6-78e640ff744c"],14101:["92e6eaf9ee","Adidas Poll Response - Test",["s"],"dd9a999f-5dbd-49a3-aa89-8581a99c7b86"],14111:["a93c5fd98c","Young Lottery Users - Test",["s"],"d62224f9-2885-42f1-a6c9-50ea5c977079"],14149:["570e89df54","All Sites | Nintendo | March Reach Campaign | Permutive",["s"],"638dea34-270f-428d-9137-69fc83f86c66"],14277:["f36cb8800d","All Sites | Extreme Sports | High Adrenaline Sports | Permutive",["s"],"63995bcb-b1a6-4ef1-b684-9940acef4605"]},i=null,r=!1,a=[],s={},o=function(t){switch(t.type){case"init":return e.init(t.msgId,t.args[0],t.args[1],t.args[2]);case"processEvents":return e.processEvents(t.msgId,t.args[0]);case"updateEnvironment":return e.updateEnvironment(t.msgId,t.args[0]);default:throw Error("Unexpected message "+t)}},c=function(t){e.postMessage({type:"complete",args:t})},u=function(t){0!==Object.keys(t).length&&e.postMessage({type:"stateChange",args:t})},l=function(t){0!==t.length&&e.postMessage({type:"errors",args:t})},d=function(e,n,d){var f={},p=[];n.forEach(function(e){var n=t[e],r=s[e];d.forEach(function(t){try{r.state=n.update(i,r.state,t)}catch(n){p.push({error:n.toString(),identifier:e,event_id:t.id})}}),r.result=n.result(i,r.state),f[e]=s[e]}),u(f),l(p),r=!0,a.forEach(o),a=[],c(e)};this.init=function(e,r,a,o){var c=a.lookalikeModels||{},u=function(e,t,n){var i=s[n].activations;e in i?-1!==i[e].indexOf(t)||i[e].push(t):i[e]=[t]};s=r,i={getCurrentTime:function(){return new Date},getCurrentSession:function(){return a.sessionId},getCurrentView:function(){return a.viewId},getSegments:function(){return a.segments},getLookalikeModels:function(){return c},setThirdPartyActivation:u,setSegmentActivation:u};var l=[];Object.keys(n).forEach(function(e){var a=n[e];if(!(e in r)||r[e].checksum!==a[0]){l.push(parseInt(e));var o=t[e],c=o.initial(i);s[e]={name:a[1],id:a[3],is_segment:a[2].indexOf("s")>-1,is_cloud:a[2].indexOf("c")>-1,checksum:a[0],state:c,result:o.result(i,c),activations:{}}}}),d(e,l,o)},this.updateEnvironment=function(t,n){if(!r)return a.push({msgId:t,type:"updateEnvironment",args:[n]});n.sessionId&&(i.getCurrentSession=function(){return n.sessionId}),n.segments&&(i.getSegments=function(){return n.segments}),n.lookalikeModels&&(i.getLookalikeModels=function(){return n.lookalikeModels}),e.processEvents(t,[{}])},this.processEvents=function(e,o){if(!r)return a.push({msgId:e,type:"processEvents",args:[o]});var d={},f=[];o.forEach(function(e){Object.keys(n).forEach(function(n){var r=t[n],a=s[n].state;try{var o=r.update(i,a,e);JSON.stringify(a)!==JSON.stringify(o)&&(s[n].state=o,s[n].result=r.result(i,o),d[n]=s[n])}catch(t){f.push({error:t.toString(),identifier:n,event_id:e.id})}})}),u(d),l(f),c(e)},onmessage=function(e){o(e.data)}}function isEntryOrExit(e){return"SegmentEntry"===e.name||"SegmentExit"===e.name}function transitionToState(e){return"SegmentEntry"===e.name}function isTrackError(e){return void 0!==e.request_id}_internals.addons={},_internals.promises=new PermutivePromises;var Events=function(e){var t={},n=[];(e=e||this).on=function(n,i,r){return(t[n]=t[n]||[]).push([i,r]),e},e.off=function(i,r){i||(t={});for(var a=t[i]||n,s=a.length=r?a.length:0;s--;)r==a[s][0]&&a.splice(s,1);return e},e.once=function(t,i){var r=n.slice.call(arguments,2),a=function(){i(r),e.off(t,a)};return e.on(t,a),e},e.emit=function(i){for(var r,a=t[i]||n,s=a.length>0?a.slice(0,a.length):a,o=0;r=s[o++];)r[0].apply(r[1],n.slice.call(arguments,1));return e}};_internals.messages=new Events;var PermutiveMessages=function(){function e(){var e=this;this.handlers={},this.messageQueue={};window.addEventListener("message",function(t){PermutiveUtils.lens(t,["data","origin"])&&"permutive"===t.data.origin&&e.handle(t)},!1),_internals.messages.once("permutive:api:ready",function(){window.postMessage({origin:"permutive",type:"sdk-init"},"*")})}return e.prototype.listen=function(e,t){if(e in this.handlers||(this.handlers[e]=[]),this.handlers[e].push(t),e in this.messageQueue)for(var n=0;n<this.messageQueue[e].length;n++){var i=this.messageQueue[e][n];this.handle(i)}},e.prototype.handle=function(e){e.data.type in this.handlers?this.handlers[e.data.type].forEach(function(t){t(e)}):(e.data.type in this.messageQueue||(this.messageQueue[e.data.type]=[]),this.messageQueue[e.data.type].push(e))},e}();_internals.extMessages=new PermutiveMessages;var EVENTS_CACHE_KEY="permutive-events-lz",EVENTS_CACHE_NO_LZ_KEY="permutive-events-cache",PermutiveEventsCache=function(){function e(e){this.state=e,this.initialised=!1,this.hasAttemptedSizeReduction=!1,this.eventObjectCache=[],this.lastRefreshed=null,this.limit=-1,this.retrieveLastRefreshTime()}return e.prototype.all=function(){return this.eventObjectCache},e.prototype.setReady=function(){this.initialised=!0,_internals.messages.emit("permutive:events:cache:loaded")},e.prototype.add=function(e,t){void 0===t&&(t={shouldWrite:!0});for(var n=!1,i=0;i<this.eventObjectCache.length;i++)if(this.eventObjectCache[i].id===e.id){n=!0;break}if(n)e=void 0;else{for(;-1!==this.limit&&this.eventObjectCache.length>=this.limit;)this.eventObjectCache.shift();this.eventObjectCache.push(e),t.shouldWrite&&this.write()}return e},e.prototype.processCachedEvents=function(e){for(var t=[],n=0;n<e.length;n++){var i=this.createEvent(e[n]);t.push(i),this.add(i,{shouldWrite:!1})}return t},e.prototype.load=function(){var e=PermutiveUtils.deferredPromise();_internals.metrics.startTimer("sdk_load_events_cache_task_duration_seconds",{});var t=function(){var e=_internals.getExternalData(EVENTS_CACHE_NO_LZ_KEY);return e?(_internals.log("Migrating uncompressed events..."),LZWorker.compress(JSON.stringify(e),function(e){_internals.setExternalData(EVENTS_CACHE_KEY,e.result)}),_internals.removeExternalData(EVENTS_CACHE_NO_LZ_KEY),e):null}();if(t)e.resolve(JSON.parse(t));else{var n=_internals.getExternalData(EVENTS_CACHE_KEY);n?LZWorker.decompress(n,function(t){e.resolve(t.result?JSON.parse(t.result):[])}):e.resolve([])}return e.promise.then(function(){_internals.metrics.stopTimer("sdk_load_events_cache_task_duration_seconds",{})}),e.promise},e.prototype.refresh=function(e){return void 0===e&&(e={processImmediately:!1}),e.from||(e.from=this.getRefreshFromTime(),this.lastRefreshed=e.from,this.storeLastRefreshTime()),_internals.log("refreshing from: ",e.from),_internals.api.events(_internals.state.userId,{error:e.error,complete:e.complete,from:e.from})},e.prototype.processRefreshEvents=function(e,t){void 0===t&&(t={});for(var n=[],i=e||[],r=0;r<i.length;r++){var a=this.add(this.createEvent(i[r]),{shouldWrite:!1});a&&n.push(a)}if(i.length>0){var s=new Date(i[i.length-1].time);s.setMilliseconds(s.getMilliseconds()+1),this.lastRefreshed=s,this.storeLastRefreshTime()}return _internals.log("events from api: ",i),_internals.log("new events from api: ",n),_internals.log("events cache",this.eventObjectCache),n.length>0&&t.write&&this.write(),n},e.prototype.reset=function(){_internals.removeExternalData(EVENTS_CACHE_KEY),this.eventObjectCache=[],this.lastRefreshed=null},e.prototype.createEvent=function(e){var t={id:e.id,name:e.name,time:new Date(e.time),properties:this.parseProperties(e.properties||{})};return e.session_id&&(t.session_id=e.session_id),e.view_id&&(t.view_id=e.view_id),t},e.prototype.write=function(e){var t=this;if(this.initialised){var n=this;_internals.log("Writing cache (#e)",this.eventObjectCache.length),LZWorker.compress(JSON.stringify(this.eventObjectCache),function(t){try{_internals.setExternalData(EVENTS_CACHE_KEY,t.result),"function"==typeof e&&e()}catch(t){if(t.message="Unable to write events to local storage: "+t.message,_internals.error(t),void 0!==t.message&&t.message.toString().toLowerCase().indexOf("quota")>-1&&!n.hasAttemptedSizeReduction){_internals.log("reducing cache size by 10%, due to local storage limit reached");for(var i=n.eventObjectCache.length;n.eventObjectCache.length>.9*i;)n.eventObjectCache.shift();n.hasAttemptedSizeReduction=!0,n.write()}}})}else _internals.messages.on("permutive:events:cache:loaded",function(){t.write(e)})},e.prototype.setRefreshFromTime=function(e){this.lastRefreshed=e,this.storeLastRefreshTime()},e.prototype.getRefreshFromTime=function(){var e=this.lastRefreshed;return e||(e=_internals.utcNow()),e&&e.setMilliseconds(e.getMilliseconds()+1),e},e.prototype.storeLastRefreshTime=function(){this.state.setPermutiveData("last_refresh_time",this.lastRefreshed.toISOString())},e.prototype.retrieveLastRefreshTime=function(){var e=this.state.getPermutiveData("last_refresh_time")||null;e&&(this.lastRefreshed=new Date(e))},e.prototype.parseProperties=function(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var i=e[n],r=i;"string"==typeof i&&i.match(ISO8601_REGEX)&&(r=new Date(i)),t[n]=r}return t},e}(),CACHED_SEGMENTS_STORAGE_KEY="_psegs",QueryManager=function(){function e(e){var t=this;this.state=e,this.initialised=!1,this.stateChangeQueue=[],this.userSegments=[],this.userSegmentsDict={},this.queryStateMap={},this.globalMsgId=0,this.resolves={},this.readSegmentCache(),this.readQueryStateCache(),this.handlers={complete:function(e){var n=t.resolves[e];n&&n(),delete t.resolves[e]},errors:function(e){e.forEach(function(e){_internals.error("QL error. "+e.error+" in query "+e.identifier+" with event "+e.event_id)})},stateChange:function(e){if(!t.initialised)return t.stateChangeQueue.push(e);for(var n in e)if(e.hasOwnProperty(n)){var i=parseInt(n),r=e[i];if(r.is_segment){var a=i in t.userSegmentsDict,s=r.result.result;if(a===s)continue;s?t.addSegment(i):t.removeSegment(i),t.trackSegmentTransition(s,r.id,i,r.name)}else{var o=t.queryStateMap[i]||{result:{}};if(JSON.stringify(o.result)===JSON.stringify(r.result))continue}_internals.messages.emit("permutive:query:changed",{queryCode:i,result:r.result})}Object.keys(e).length>0&&(t.queryStateMap=PermutiveUtils.merge(t.queryStateMap,e),t.writeSegmentCache(),t.writeQueryStateCache()),_internals.messages.emit("permutive:segments:updated")}};var n=new Blob([("("+QueryWorker+")();").replace('"use strict";',"")],{type:"application/javascript"});this.worker=new Worker(URL.createObjectURL(n)),this.worker.onmessage=function(e){switch(e.data.type){case"stateChange":return t.handlers.stateChange(e.data.args);case"errors":return t.handlers.errors(e.data.args);case"complete":return t.handlers.complete(e.data.args)}},this.worker.onerror=function(e){e.preventDefault(),_internals.error("WebWorker error: "+e.message)}}return e.prototype.initWorker=function(e){return this.sendMessage({type:"init",args:[this.queryStateMap,{segments:{"1p":this.userSegmentsDict},sessionId:_internals.sessionManager.getSessionId(),viewId:_internals.state.getViewId(),lookalikeModels:{}},e]})},e.prototype.updateEnvironment=function(e){return this.sendMessage({type:"updateEnvironment",args:[e]})},e.prototype.updateWithHistoricSegments=function(e){return 0===e.length?Promise.resolve():(this.updateSegmentResults(e),this.sendMessage({type:"processEvents",args:[e]}))},e.prototype.update=function(e){var t=this.sendMessage({type:"processEvents",args:[e]});return _internals.isRealtime||t.then(function(){_internals.setAsRealtime()}),t},e.prototype.updateSegmentResults=function(e){var t=this;if(0!==e.length){var n=this.calculateHistoricSegments(e);_internals.log("New segment states",n),Object.keys(n).forEach(function(e){var i=parseInt(e);n[i]?t.addSegment(i):t.removeSegment(i)}),Object.keys(n).length>0&&this.writeSegmentCache()}},e.prototype.handleResult=function(e,t){e in this.queryStateMap&&t(this.queryStateMap[e].result)},e.prototype.getActivations=function(){var e={};for(var t in this.queryStateMap)if(this.queryStateMap.hasOwnProperty(t)){var n=this.queryStateMap[t].activations;for(var i in n)if(this.queryStateMap[t].activations.hasOwnProperty(i))for(var r=this.queryStateMap[t].activations[i],a=0;a<r.length;a++)t in e||(e[t]=[]),e[t].push({segment_id:t,data_provider_id:i,data_provider_segment_id:r[a]})}return e},e.prototype.reset=function(){this.clearSegmentCache(),this.clearQueryStateCache(),this.userSegments=[],this.userSegmentsDict={},this.queryStateMap={}},e.prototype.setAsReady=function(){this.initialised=!0,this.processStateChangeQueue(),_internals.messages.emit("permutive:queries:initialised")},e.prototype.processStateChangeQueue=function(){_internals.log("state change queue",this.stateChangeQueue);var e=this.stateChangeQueue.reduce(function(e,t){return PermutiveUtils.merge(e,t)},{});this.stateChangeQueue=[],_internals.log("final state",e),this.handlers.stateChange(e)},e.prototype.sendMessage=function(e){var t=this,n=this.globalMsgId++;return new Promise(function(i,r){t.resolves[n]=i,e.msgId=n,t.worker.postMessage(e)})},e.prototype.addSegment=function(e){this.userSegmentsDict[e]||(this.userSegments.push(e),this.userSegmentsDict[e]=!0)},e.prototype.removeSegment=function(e){if(e in this.userSegmentsDict){delete this.userSegmentsDict[e];var t=this.userSegments.indexOf(e);t>-1&&this.userSegments.splice(t,1)}},e.prototype.calculateHistoricSegments=function(e){for(var t={},n=0;n<e.length;n++){var i=e[n];isEntryOrExit(i)&&(t[i.properties.segment_number]=transitionToState(i))}return t},e.prototype.trackSegmentTransition=function(e,t,n,i){var r=e?"SegmentEntry":"SegmentExit",a={segment_id:t,segment_number:n,segment_name:i};permutive.track(r,a)},e.prototype.writeSegmentCache=function(){_internals.log("Writing segment cache");var e=JSON.stringify(this.userSegments);_internals.setExternalData(CACHED_SEGMENTS_STORAGE_KEY,e)},e.prototype.readSegmentCache=function(){var e=this,t=localStorage.getItem(CACHED_SEGMENTS_STORAGE_KEY);t&&(this.userSegments=JSON.parse(t),this.userSegments.forEach(function(t){e.userSegmentsDict[t]=!0})),_internals.log("Read segment cache",this.userSegments)},e.prototype.clearSegmentCache=function(){localStorage.removeItem(CACHED_SEGMENTS_STORAGE_KEY)},e.prototype.writeQueryStateCache=function(){_internals.log("Writing query state cache",this.queryStateMap),this.state.setPermutiveData("query_states",this.queryStateMap)},e.prototype.readQueryStateCache=function(){this.queryStateMap=this.state.getPermutiveData("query_states")||{},_internals.log("Read query state cache",this.queryStateMap)},e.prototype.clearQueryStateCache=function(){this.state.setPermutiveData("query_states",{})},e}(),PermutiveReaction=function(){function e(e,t,n,i,r,a,s){this.id=e,this.segmentCode=t,this.segmentName=n,this.reactionType=i,this.triggerType=r,this.variantId=a,this.config=s}return e.prototype.reactEveryTime=function(){return"EveryTime"===this.triggerType},e.prototype.reactOnEntry=function(){return"OnEntry"===this.triggerType},e.prototype.reactOnExit=function(){return"OnExit"===this.triggerType},e.prototype.trackImpression=function(e){var t={reaction_id:this.id,variant_id:this.variantId,type:"impression"};permutive.track("Reaction",t,e),_internals.log("impression: ",t)},e.prototype.trackConversion=function(e){var t={reaction_id:this.id,variant_id:this.variantId,type:"conversion"};permutive.track("Reaction",t,e),_internals.log("conversion: ",t)},e}(),PermutiveReactionManager=function(){function e(e){this.state=e,this.reactionsConfig=[],this.specializedReactionsConfig={target_dfp:{dfp:[11808,12190,11600,12048,11722,11815,11431,11617,11811,13808,12042,11710,12977,11688,11817,11691,11684,11700,11693,11694,12753,11652,14078,13809,11651,14277,14101,11698,11687,11632,12456,11621,11812,11686,10895,11701,11690,11430,11814,11799,11631,11432,11681,12195,11592,11597,11633,11611,11619,11870,11598,11591,11604,11605,11627,11816,12023,11610,11807,11595,11793,11697,11806,11616,13079,11620,11805,11596,11879,12046,11682,11692,11626,11813,11809,11668,12045,11680,11618,12047,11649,13883,11606,11699,11696,11689,13810,11607,11601,11650,11923,11944,11653,11819,11609],dfp_legacy:{}},eyeota_pixel:[],dbm:{omitted:0},appnexus:{12977:17195485,13058:17217627},appnexus_adserver:[],nativo:[]},this.reactions={},this.hasher=function(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}}return e.prototype.load=function(){for(var e=0;e<this.reactionsConfig.length;e++){var t=this.reactionsConfig[e];this.reactions[t.reaction_type]?this.reactions[t.reaction_type].push(t):this.reactions[t.reaction_type]=[t]}},e.prototype.evaluateContextCriteria=function(e){for(var t=0;t<e.criteria.length;t++){var n=function(e){var t=permutive.context[e.key];return void 0!==t&&("EQUALS"===e.comparison?t===e.value:"NOT_EQUALS"===e.comparison?t!==e.value:"CONTAINS"===e.comparison?t.indexOf(e.value)>=0:"NOT_CONTAINS"===e.comparison&&t.indexOf(e.value)<0)}(e.criteria[t]);if("AND"===e.operator&&!n)return!1;if("OR"===e.operator&&n)return!0}return"AND"===e.operator},e.prototype.selectVariant=function(e,t){if(1===t.length)return t[0];var n=this.state.userId+e,i=Math.abs(this.hasher(n))%12e4;t.sort(function(e,t){return e.start_bucket-t.start_bucket});var r=t.findIndex(function(e){return i<e.start_bucket});return t[r>=0?r-1:t.length-1]},e.prototype.getSpecializedReactions=function(e){return this.specializedReactionsConfig[e]},e.prototype.getReactions=function(e){var t=[];if(this.reactions[e])for(var n=0;n<this.reactions[e].length;n++){var i=this.reactions[e][n],r=this.selectVariant(i.id,i.variants);if(r){var a=r.context_criteria;a&&!this.evaluateContextCriteria(a)||t.push(new PermutiveReaction(i.id,r.segment_code,"",i.reaction_type,i.trigger_type,r.id,r.config))}}return t},e}(),PermutiveTaskQueue=function(){function e(){var e=this;this.queue=[],this.nextNotify=null,_internals.messages.on("permutive:taskQueue:update",function(){e.execute()})}return e.prototype.add=function(e){this.queue.push(e),this.notify()},e.prototype.notify=function(){var e=function(){_internals.messages.emit("permutive:taskQueue:update")},t=(new Date).getTime();null===this.nextNotify||this.nextNotify<t-50?(this.nextNotify=t,e()):this.nextNotify<=t&&(this.nextNotify=t+50,window.setTimeout(e,50))},e.prototype.execute=function(){var e=this;if(0!==this.queue.length){for(var t=!1,n=!1,i=0,r=0;r<this.queue.length;r++){var a=this.queue[r];if(a.complete)i+=1;else if(a.started)n=!0,t=t||a.blocks();else{if(a.waits()&&n)break;t||(n=!0,t=t||a.blocks(),a.execute(function(){e.notify()}))}}this.queue.splice(0,i)}},e.prototype.size=function(){return this.queue.length},e}(),Task=function(){function e(e,t){void 0===t&&(t={}),this.wait_prev=t.wait_prev||!1,this.block_next=t.block_next||!1,this.description=t.description||"",this.started=!1,this.complete=!1,this.task=e}return e.prototype.waits=function(){return this.wait_prev},e.prototype.blocks=function(){return this.block_next},e.prototype.execute=function(e){var t=this;this.started=!0,this.task(function(){t.complete=!0,e()})},e}(),SessionManager=function(){function e(e){(e=e||{}).timeout_seconds=e.timeout_seconds||1800,e.session_data_key=e.session_data_key||"permutive-session",this.options=e,this.session_id=null,this.initialize()}return e.prototype.getSessionId=function(){return this.session_id},e.prototype.newSession=function(e){return{session_id:_internals.randomUuid(),last_updated:e}},e.prototype.initialize=function(){var e=new Date,t=_internals.getCookie(this.options.session_data_key),n=this.decodeSessionData(t);if(null===n)n=this.newSession(e);else{var i=this.options.timeout_seconds;e>new Date(n.last_updated.getTime()+1e3*i)?n=this.newSession(e):n.last_updated=e}this.persistSessionData(n),this.session_id=n.session_id},e.prototype.decodeSessionData=function(e){var t=null;try{t=JSON.parse(e)}catch(e){return null}return null!==t&&"object"==typeof t&&t.hasOwnProperty("session_id")&&t.hasOwnProperty("last_updated")&&(t.last_updated=new Date(t.last_updated),!isNaN(t.last_updated.getTime()))?t:null},e.prototype.persistSessionData=function(e){e.last_updated=e.last_updated.toISOString(),_internals.setCookie(this.options.session_data_key,JSON.stringify(e))},e}(),ISO8601_REGEX=/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-3])((:?)[0-5]\d)?|24\:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/,PermutiveState=function(){function e(){this.taskQueue=new PermutiveTaskQueue;var e=_internals.getNamespacedStorageKey(permutive.config.permutiveDataKey),t=localStorage.getItem(e);this.permutiveData=null===t?{}:JSON.parse(t),this.userId=this.getUserId(),this.isFirstVisitOnDevice=null===this.userId,this.viewId=_internals.randomUuid(),this.eventsCache=new PermutiveEventsCache(this),this.reactionManager=new PermutiveReactionManager(this),this.reactionManager.load(),this.queryManager=new QueryManager(this)}return e.prototype.reset=function(){_internals.log("Resetting SDK"),this.queryManager.reset(),this.eventsCache.reset(),_internals.deleteCookie(permutive.config.cookieName),_internals.removeExternalData(permutive.config.cookieName),this.permutiveData={},localStorage.removeItem(permutive.config.permutiveDataKey)},e.prototype.getUserId=function(){var e=_internals.getCookie(permutive.config.cookieName);return e||_internals.getExternalData(permutive.config.cookieName)},e.prototype.setUserId=function(e){_internals.setCookie(permutive.config.cookieName,e),_internals.setExternalData(permutive.config.cookieName,e),this.userId=e},e.prototype.getPermutiveData=function(e){return this.permutiveData[e]},e.prototype.setPermutiveData=function(e,t){this.permutiveData[e]=t;var n=_internals.getNamespacedStorageKey(permutive.config.permutiveDataKey);localStorage.setItem(n,JSON.stringify(this.permutiveData))},e.prototype.getPageviewId=function(){return this.getViewId()},e.prototype.getViewId=function(){return this.viewId},e.prototype.getClient=function(){var e="";return e=document.title?document.title:"",{type:"web",user_agent:navigator.userAgent?navigator.userAgent:"",url:window.location.href?window.location.href:"",domain:window.location.hostname?window.location.hostname:"",title:e,referrer:document.referrer?document.referrer:""}},e}(),PermutiveApi=function(){function e(){}return e.prototype.identify=function(e,t){if(void 0===t&&(t={}),e.forEach(function(e){return _internals.identities.addAlias(e.id,e.tag)}),_internals.isIdentityReady){var n=_internals.identities.currentAliases;this.sendIdentify(_internals.state.userId,n,t).then(function(e){return _internals.identities.storeAliases(n)})}},e.prototype.sendIdentify=function(e,t,n){void 0===n&&(n={});var i={default:0,appnexus:1},r=function(e){return _internals.identities.getIdentity(e).defined?e in i?i[e]+1:1:0},a={user_id:e,aliases:function(e){return Object.keys(e).map(function(t){return{id:e[t],tag:t,priority:r(t)}})}(t)};return _internals.req({url:_internals.getEndpointUrl("/identify"),method:"POST",data:a,success:n.success,error:n.error,complete:n.complete,contentType:"text/plain",apiKeyInParams:!0})},e.prototype.setUserProperties=function(e,t){return void 0===t&&(t={}),_internals.req({url:_internals.getEndpointUrl("/users/"+_internals.state.userId+"/properties"),method:"POST",data:{properties:e},success:t.success,error:t.error,complete:t.complete,contentType:"text/plain",apiKeyInParams:!0})},e.prototype.metrics=function(e,t){return void 0===t&&(t={}),_internals.req({url:_internals.getEndpointUrl("/internal/metrics"),method:"POST",data:e,contentType:"text/plain",dataType:"text",apiKeyInParams:!0,success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(n)}})},e.prototype.track=function(e,t,n,i,r,a){void 0===a&&(a={});var s=n||{};a.includeClient=(a.includeClient,!0),a.includeClient&&(s.client=_internals.state.getClient());var o={user_id:e,name:t,segments:_internals.state.queryManager.userSegments,properties:s};return null!==i&&(o.session_id=i),null!==r&&(o.view_id=r),_internals.req({url:_internals.getEndpointUrl("/events"),method:"POST",data:o,success:function(e){a.success&&a.success(e)},error:function(e,t){a.error&&a.error(t)},complete:a.complete,contentType:"text/plain",apiKeyInParams:!0,useBeacon:a.useBeacon})},e.prototype.events=function(e,t){void 0===t&&(t={});var n=_internals.getEndpointUrl("/events")+"?user_id="+e;return t.from&&(n+="&from="+t.from.toISOString()),_internals.req({url:n,method:"GET",success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(n)},complete:t.complete,apiKeyInParams:!0,contentType:"text/plain"})},e.prototype.tpd=function(e,t){void 0===t&&(t={});var n=_internals.getEndpointUrl("/tpd");return _internals.req({url:n,method:"POST",data:{user_id:e},success:function(e){t.success&&t.success(e)},error:function(e,n){t.error&&t.error(n)},complete:t.complete,contentType:"text/plain",apiKeyInParams:!0})},e}(),EventHandler=function(){function e(){this.events=[],this.listeners=[]}return e.prototype.newEvent=function(e){var t=this;this.events.push(e),this.listeners.forEach(function(n){t.handle(e,n)})},e.prototype.addListener=function(e){var t=this;this.listeners.push(e);var n={replay:function(){return t.replay(e),n},remove:function(){return t.remove(e),n}};return n},e.prototype.handle=function(e,t){var n="string"==typeof t.name&&e.name===t.name,i=t.name.test&&t.name.test(e.name),r=n||i;if(r)try{t.callback(e)}catch(e){window.console&&window.console.error&&window.console.error("callback error: ",e)}r&&t.once&&this.remove(t)},e.prototype.replay=function(e){for(var t=-1!==this.listeners.indexOf(e),n=0;n<this.events.length&&t;n++)this.handle(this.events[n],e),t=-1!==this.listeners.indexOf(e)},e.prototype.remove=function(e){var t=this.listeners.indexOf(e);-1!==t&&this.listeners.splice(t,1)},e}(),PermutiveMethods=function(){function e(){}return e.prototype.identify=function(e){_internals.log("<call> identify",e);var t=PermutiveIdentities.getAliasesFromIdentifyArg(e),n=PermutiveUtils.deferredPromise();if(_internals.api){_internals.state.taskQueue.add(new Task(function(e){_internals.log("<task> identify ",t);var i=_internals.state.userId,r={success:function(r){var a=r.user_id;if(a!==i){var s={error:function(){_internals.error("couldn't retrieve events for user "+a),e(),n.resolve()},from:new Date(0)};_internals.state.reset(),_internals.state.setUserId(a),_internals.state.eventsCache.refresh(s).then(function(i){var r=_internals.state.eventsCache.processRefreshEvents(i,{write:!0});_internals.state.queryManager.updateSegmentResults(r),_internals.state.queryManager.initWorker(r).then(function(){_internals.log("<done> identify",t,r),e(),n.resolve()})})}else _internals.log("<done> identify ",t),e(),n.resolve()},error:function(){_internals.error("Couldn't set identity for user "+i),e(),n.resolve()}};_internals.api.identify(t,r)},{wait_prev:!0,block_next:!0}))}else _internals.error("The API hasn't been loaded."),n.reject();return n.promise},e.prototype.on=function(e,t){return _internals.eventHandler.addListener({name:e,callback:t,once:!1})},e.prototype.once=function(e,t){return _internals.eventHandler.addListener({name:e,callback:t,once:!0})},e.prototype.track=function(e,t,n){void 0===n&&(n={}),_internals.log("<call> track",e);var i=PermutiveUtils.deferredPromise();if(_internals.api){var r=n.success;_internals.state.taskQueue.add(new Task(function(a){_internals.log("<task> track",e);var s=_internals.sessionManager.getSessionId(),o=_internals.state.getViewId(),c=!!n.isAnalyticsOnly;_internals.api.track(_internals.state.userId,e,t,s,o,{useBeacon:n.useBeacon,success:function(e){if(isTrackError(e))_internals.log("Tracking failed with reason",e),i.resolve({});else{_internals.eventHandler.newEvent(e);var t={};n.useBeacon||(t=_internals.state.eventsCache.createEvent(e),c||(_internals.state.eventsCache.add(t),_internals.state.queryManager.update([t]))),r&&r(t),i.resolve(t)}},complete:function(){_internals.log("<done> track",e),a()}})}))}else _internals.error("The API hasn't been loaded."),i.reject();return i.promise},e.prototype.trigger=function(e,t,n){var i=PermutiveUtils.deferredPromise();_internals.log("<call> trigger",e),_internals.triggerListeners=_internals.triggerListeners||[];return _internals.state.taskQueue.add(new Task(function(t){_internals.log("<task> trigger",e);var r=_internals.messages.on("permutive:query:changed",function(t){t.queryCode===e&&(n(t.result),i.resolve(t.result))});_internals.triggerListeners.push(r),_internals.log("<done> trigger",e),t()})),i.promise},e.prototype.query=function(e,t){var n=PermutiveUtils.deferredPromise();_internals.log("<call> query",e);return _internals.state.taskQueue.add(new Task(function(i){_internals.log("<task> query",e),_internals.state.queryManager.handleResult(e,function(e){t(e),n.resolve(e)}),_internals.log("<done> query",e),i()})),n.promise},e.prototype.segment=function(e,t){var n=PermutiveUtils.deferredPromise();_internals.log("<call> segment",e);return _internals.state.taskQueue.add(new Task(function(i){_internals.log("<task> segment",e),_internals.state.queryManager.handleResult(e,function(i){if("boolean"!=typeof i.result)throw new Error("Segment "+e+" is missing boolean result property");t(i.result),n.resolve(i.result)}),_internals.log("<done> segment",e),i()})),n.promise},e.prototype.segments=function(e,t){void 0===t&&(t="all");var n=PermutiveUtils.deferredPromise();_internals.log("<call> segments");return _internals.state.taskQueue.add(new Task(function(i){_internals.log("<task> segments ("+t+")");var r=function(r){e(r),n.resolve(r),_internals.log("<done> segments ("+t+")"),i()};"dfp"===t?void 0!==_internals.addons.dfp&&_internals.addons.dfp.isReady?r(_internals.addons.dfp.liveSegments):_internals.messages.once("permutive:dfp:ready",function(){r(_internals.addons.dfp.liveSegments)}):r(_internals.state.queryManager.userSegments)})),n.promise},e.prototype.reset=function(){var e=PermutiveUtils.deferredPromise();return _internals.createUser(function(t){_internals.state.reset(),_internals.state.setUserId(t.user_id),_internals.state.eventsCache.refresh({error:function(){return e.resolve()}}).then(function(e){var t=_internals.state.eventsCache.processRefreshEvents(e,{write:!0});return _internals.state.queryManager.updateWithHistoricSegments(t)}).then(function(){return e.resolve()}),_internals.messages.emit("permutive:reset")}),e.promise},e.prototype.addon=function(e,t){if(_internals.addons[e])"web"===e&&!0!==t.auto_init&&_internals.addons[e].reset(t);else switch(e){case"web":_internals.addons.web=new WebAddon(t);break;case"publishers":_internals.addons.publishers=new PublishersAddon(t);break;case"overlays":_internals.addons.overlays=new OverlaysAddon(t);break;case"scriptrunner":_internals.addons.scriptrunner=new ScriptRunnerAddon(t);break;case"dfp":_internals.addons.dfp=new DFPAddon(t);break;case"smart":_internals.addons.smart=new SmartAddon(t);break;case"nativo":_internals.addons.nativo=new NativoAddon(t);break;case"freewheel":_internals.addons.freewheel=new FreeWheelAddon(t);break;case"gigya":_internals.addons.gigya=GigyaAddon(t);break;case"facebook_pixel":_internals.addons.facebook_pixel=new FacebookPixelAddon(t);break;case"facebook_pixel_v2":_internals.addons.facebook_pixel_v2=new FacebookPixelV2Addon(t);break;case"eyeota_pixel":_internals.addons.eyeota_pixel=new EyeotaPixelAddon(t);break;case"pubmatic":_internals.addons.pubmatic=new PubMaticAddon(t);break;case"tradedesk":_internals.addons.tradedesk=new TradeDeskAddon(t);break;case"adwords":case"dbm":_internals.addons.ddp=new DDPAddon(t);break;case"rubicon":_internals.addons.rubicon=new RubiconAddon(t);break;case"aol":_internals.addons.aol=new AOLAddon(t);break;case"lotame":_internals.addons.lotame=new LotameAddon(t);break;case"tracking_pixel":_internals.addons.tracking_pixel=new PixelAddon(t);break;case"twitter_pixel":_internals.addons.twitter_pixel=new TwitterAddon(t);break;case"pinterest_pixel":_internals.addons.pinterest_pixel=new PinterestAddon(t);break;case"local_storage":_internals.addons.local_storage=new LocalStorageAddon(t);break;case"appnexus":_internals.addons.appnexus=new AppNexusAddon(t);break;case"appnexus_adserver":_internals.addons.appnexus_adserver=new AppNexusAdServerAddon(t)}},e.prototype.ready=function(e,t){void 0===t&&(t="initialised");var n=PermutiveUtils.deferredPromise();switch(t){case"initialised":_internals.isReady?(e(),n.resolve()):_internals.messages.on("permutive:ready",function(){e(),n.resolve()});break;case"realtime":_internals.isRealtime?(e(),n.resolve()):_internals.messages.once("permutive:realtime",function(){e(),n.resolve()})}return n.promise},e}(),PermutiveIdentities=function(){function e(){this.identities=_internals.state.getPermutiveData("identities")||{},this.previousAliases=PermutiveUtils.extend({},_internals.state.getPermutiveData("aliases")),this.currentAliases=_internals.state.getPermutiveData("aliases")||{},this.providers={}}return e.getAliasesFromIdentifyArg=function(e){var t=this;if("string"!=typeof e&&"object"!=typeof e||null===e||""===e)throw new Error("Identify must be passed a non-empty string or list of aliases, value passed was '"+e+"'");var n="string"==typeof e?[{id:e,tag:"default"}]:e,i=n.filter(function(e){return t.reservedAliasTags.indexOf(e.tag)>-1}).map(function(e){return e.id});if(i.length>0)throw new Error("Identify was called with one or more reserved alias tags: "+i.join(","));return n},e.prototype.setIdentity=function(e,t,n){void 0===n&&(n=86400),this.identities[e]={value:t,expiry:Date.now()+Math.floor(1e3*n)},_internals.state.setPermutiveData("identities",this.identities)},e.prototype.getIdentity=function(e){return e in this.identities?{defined:!0,value:this.identities[e].value}:{defined:!1,value:void 0}},e.prototype.getIdentities=function(e){var t=this;return void 0===e&&(e=!1),Object.keys(this.identities).reduce(function(n,i){var r=t.getIdentity(i).value;return void 0!==r&&(e&&!t.getProvider(i).usedForThirdPartyData()||(n[i]=r)),n},{})},e.prototype.hasExpired=function(e){return!(e in this.identities)||Date.now()>=this.identities[e].expiry},e.prototype.registerProvider=function(e){this.providers[e.getTag()]=e},e.prototype.getProvider=function(e){return e in this.providers?this.providers[e]:(_internals.error("Identity provider "+e+" is not registered."),null)},e.prototype.retrieveIdentity=function(e){var t=this,n=this.getProvider(e);return null===n?Promise.resolve(void 0):n.getId().then(function(e){var i=void 0===e?"sdk_third_party_identity_missing_count":"sdk_third_party_identity_present_count";return _internals.metrics.track({name:i,value:1,labels:{identity_tag:n.getTag()}}),t.setIdentity(n.getTag(),e,n.getTtlInSeconds()),e})},e.prototype.retrieveAllIdentities=function(){_internals.metrics.startTimer("sdk_get_third_party_identities_task_duration_seconds",{});var e=[],t=this;for(var n in this.providers)!function(n){if(!t.providers.hasOwnProperty(n))return"continue";var i=t.getIdentity(n),r=!i.defined||t.hasExpired(n)?t.retrieveIdentity(n):Promise.resolve(i.value);r.then(function(e){return void 0!==e?_internals.api.identify([{id:e,tag:n}]):null}),e.push(r)}(n);return Promise.all(e).then(function(e){return _internals.metrics.stopTimer("sdk_get_third_party_identities_task_duration_seconds",{}),e})},e.prototype.addAlias=function(e,t){this.currentAliases[t]=e},e.prototype.storeAliases=function(e){_internals.state.setPermutiveData("aliases",e)},e.prototype.areAliasesEqual=function(e,t){var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(var r=0;r<n.length;r++){var a=n[r];if(!(a in t))return!1;if(t[a]!==e[a])return!1}return!0},e.reservedAliasTags=["appnexus","amp","gigya","sailthru","idfa","aaid"],e}(),providerToIdMap={permutive:"1",eyeota:"2",nielsen:"3",skimlinks:"4",comscore:"5",eyeota_bombora:"6",eyeota_aimmatic:"7",eyeota_alc:"8",eyeota_amberdata:"9",eyeota_caci:"10",eyeota_corelogic:"11",eyeota_dlg:"12",eyeota_dataxpand:"13",eyeota_dunbradstreet:"14",eyeota_experian:"15",eyeota_gbgtransactis:"16",eyeota_gfk:"17",eyeota_rdaresearch:"18",eyeota_kantarmedia:"19",eyeota_mastercard:"20",eyeota_meritdirect:"21",eyeota_netsprint:"22",eyeota_nri:"23",eyeota_onaudience:"24",eyeota_pacificdatapartners:"25",eyeota_plungedigital:"26",eyeota_roymorgan:"27",eyeota_schober:"28",eyeota_sharethis:"30",eyeota_skimlinks:"31",eyeota_specialists:"32",eyeota_statsocial:"33",eyeota_stirista:"34",eyeota_yougov:"36"},PermutiveThirdParty=function(){function e(){this.userSegments=_internals.state.getPermutiveData("third-party-data")||{expiry_time:Date.now()-1,segments:{}},this.ttlInSeconds=86400}return e.prototype.fireThirdPartySegmentEvent=function(){var e=this,t=new Date(_internals.state.getPermutiveData("date_tpd_segment_event_sent")||null);(Date.now()-t.getTime())/864e5>=30&&(Object.keys(this.userSegments.segments).forEach(function(t){permutive.track("ThirdPartySegments",{data_provider:t,segments:Object.keys(e.userSegments.segments[t])},{isAnalyticsOnly:!0})}),_internals.state.setPermutiveData("date_tpd_segment_event_sent",Date.now()))},e.prototype.segments=function(){var e=this;if(this.segmentsPromise)return this.segmentsPromise;if(Date.now()<this.userSegments.expiry_time)return Promise.resolve(this.userSegments.segments);var t=PermutiveUtils.deferredPromise();_internals.metrics.startTimer("sdk_get_third_party_data_task_duration_seconds",{});var n=_internals.identities.getIdentities(!0);Object.keys(n).length>0?_internals.api.tpd(n,{success:function(n){var i=e.convertSegments(n),r=Date.now()+Math.floor(1e3*e.ttlInSeconds);e.userSegments.expiry_time=r,e.updateCache(i),t.resolve(i)},error:function(e){_internals.error("Third Party Data segments retrieval failed with reason: "+e),t.resolve({})}}):t.resolve({});var i=_internals.promises.getPromisesByCategory("tpd"),r=Promise.all(i.map(function(e){return e.promise})).then(function(e){return t.promise}).then(function(t){return e.getSegments()});return r.then(function(){_internals.metrics.stopTimer("sdk_get_third_party_data_task_duration_seconds",{})}),this.segmentsPromise=r,this.segmentsPromise},e.prototype.addSegments=function(e,t){var n={};n[e]=t;var i=this.convertSegments(n);this.updateCache(i)},e.prototype.getSegments=function(){return this.userSegments.segments},e.prototype.getActivationMetadata=function(){var e=_internals.state.queryManager.getActivations(),t={};for(var n in e)if(e.hasOwnProperty(n)){var i=e[n].map(function(e){return[n,providerToIdMap[e.data_provider_id],e.data_provider_segment_id].join("-")});t[n]=i}return t},e.prototype.updateCache=function(e){this.userSegments.segments=PermutiveUtils.mergeNestedObjects(this.userSegments.segments,e),_internals.state.setPermutiveData("third-party-data",this.userSegments)},e.prototype.convertSegments=function(e){return Object.keys(e).reduce(function(t,n){var i=e[n];return t[n]=i.reduce(function(e,t){return e[t]=!0,e},{}),t},{})},e}(),PermutiveModels=function(){function e(){var e=this;this.MODELS_LAST_UPDATED_KEY="models_last_updated",this.MODELS_DATA_KEY="models_data",this.MODELS_SYNC_TIMEOUT_IN_SECONDS=86400,this.idToProviderMap=PermutiveUtils.swap(providerToIdMap);var t=_internals.state.getPermutiveData(this.MODELS_LAST_UPDATED_KEY);isNaN(t)||(new Date).getTime()>t+1e3*this.MODELS_SYNC_TIMEOUT_IN_SECONDS?(this.models=this.fetchModels(),this.models.then(function(t){_internals.state.setPermutiveData(e.MODELS_DATA_KEY,t),_internals.state.setPermutiveData(e.MODELS_LAST_UPDATED_KEY,(new Date).getTime())})):this.models=new Promise(function(t){t(_internals.state.getPermutiveData(e.MODELS_DATA_KEY))})}return e.prototype.getModels=function(){return this.models},e.prototype.extractModelsFromJsonArray=function(e){for(var t=this,n={},i=0;i<e.length;i++){var r=e[i],a=r.weights,s={"1p":{}};void 0!==r.id&&void 0!==a&&(Object.keys(a).forEach(function(e){var n=e.split("-");if(2===n.length){var i=t.idToProviderMap[n[0]],r=n[1];s[i]||(s[i]={}),s[i][r]=a[e]}else s["1p"][e]=a[e]}),n[r.id]=s)}return n},e.prototype.fetchModels=function(){var e=this;return PermutiveUtils.ajax({url:"https://"+_internals.config.cdnBaseUrl+"/models/"+_internals.config.projectId+"-models.json",type:"GET",dataType:"json"}).then(function(t){return e.extractModelsFromJsonArray(t.models)},function(e){return{}})},e}();permutive.addons=_internals.addons;try{var metricsEnabled=void 0!==sdkInitTimestamp&&Math.random()<=_internals.config.metricsSamplingPercentage/100;_internals.metrics=metricsEnabled?new PermutiveMetrics(sdkInitTimestamp):new PermutiveMetricsNoOp,_internals.sessionManager=new SessionManager,_internals.state=new PermutiveState;var eventCache_1=_internals.state.eventsCache.load();_internals.models=new PermutiveModels,_internals.api=new PermutiveApi,_internals.identities=new PermutiveIdentities,_internals.thirdParty=new PermutiveThirdParty,permutive.context=permutive.context||{},permutive.context.path=window.location.pathname,permutive.context.url=window.location.href,permutive.context.referrer=document.referrer,_internals.blockers=[],_internals.addBlocker("permutive:queries:initialised");for(var scripts=[],i=0;i<scripts.length;i++){var script=scripts[i];try{eval(script)}catch(e){e.message="Error running custom script ["+i+"]"+e.message,_internals.error(e)}}var AppNexusIdentityProvider=function(){function e(){this.url="//ib.adnxs.com/getuidj",this.invalidAliases=["0","-1"]}return e.prototype.getTag=function(){return"appnexus"},e.prototype.getId=function(){var e=this;return PermutiveUtils.ajax({url:this.url,xhrFields:{withCredentials:!0},timeout:3e3}).then(function(t){return"uid"in t&&e.isValidAlias(t.uid)?Promise.resolve(t.uid):Promise.resolve(void 0)},function(t){return _internals.error("Failed to retrieve third-party identity for "+e.getTag()),Promise.resolve(void 0)})},e.prototype.getTtlInSeconds=function(){return 86400},e.prototype.usedForThirdPartyData=function(){return!0},e.prototype.isValidAlias=function(e){return-1===this.invalidAliases.indexOf(e)},e}();!function(){var e=new AppNexusIdentityProvider;_internals.identities.registerProvider(e)}();var RUBICON_SEGMENTS_STORAGE_KEY_1="_prps";!function(){permutive.q.push({functionName:"addon",arguments:["rubicon",{}]});var e=_internals.getExternalData(RUBICON_SEGMENTS_STORAGE_KEY_1),t=e?JSON.parse(e):[];"undefined"!=typeof googletag?googletag.cmd.push(function(){"undefined"!=typeof rubicontag&&rubicontag.setFPI&&rubicontag.setFPI("permutive",t.join(","))}):"undefined"!=typeof rubicontag&&rubicontag.setFPI&&rubicontag.cmd.push(function(){rubicontag.setFPI("permutive",t.join(","))})}();var RubiconAddon=function(){function e(e){var t=this;this.reactions=_internals.state.reactionManager.getReactions("target_rubicon"),this.segments={};for(var n=0;n<this.reactions.length;n++){var i=this.reactions[n].segmentCode;this.segments[i]=!0}this.exportSegments(),_internals.messages.on("permutive:segments:updated",makeSafe(function(){t.exportSegments()})),_internals.messages.on("permutive:reset",makeSafe(function(){_internals.removeExternalData(RUBICON_SEGMENTS_STORAGE_KEY_1)}))}return e.prototype.exportSegments=function(){var e=this,t=_internals.state.queryManager.userSegments,n=_internals.thirdParty.getActivationMetadata(),i=[],r=e.segments;t.forEach(function(e){e in r&&(i.push(e.toString()),i.push.apply(i,n[e]||[]))}),i.length>0&&(_internals.setExternalData(RUBICON_SEGMENTS_STORAGE_KEY_1,JSON.stringify(i)),"undefined"!=typeof googletag?googletag.cmd.push(function(){"undefined"!=typeof rubicontag&&rubicontag.setFPI&&rubicontag.setFPI("permutive",i.join(","))}):"undefined"!=typeof rubicontag&&rubicontag.setFPI&&rubicontag.cmd.push(function(){rubicontag.setFPI("permutive",i.join(","))}))},e}();permutive.q.unshift({functionName:"addon",arguments:["overlays",{}]});var isHtmlOverlay_1=function(e){return void 0!==e.html},isImageOverlay_1=function(e){return void 0!==e.image_url&&void 0!==e.image_link},OverlaysAddon=function(){function e(e){var t=this;this.reactions=_internals.state.reactionManager.getReactions("show_overlay"),this.loadedImageCounts={};for(var n=this,i=0;i<this.reactions.length;i++)!function(){var e=n.reactions[i],r=e.config,a=n.buildOverlayCss(r,i);document.head.insertAdjacentHTML("beforeend",a);var s=n.buildOverlayBody(r,i);document.body.insertAdjacentHTML("beforeend",s);var o="permutive-overlay-"+i,c=document.getElementById(o);!function(e,t){e.getElementsByClassName("close")[0].addEventListener("click",function(){e.style.visibility="hidden",e.style.opacity="0"})}(c),function(e,t,n){[].slice.call(e.getElementsByTagName("a")).slice(1).forEach(function(e){e.addEventListener("click",function(e){e.preventDefault();var t=this.href;n.trackConversion({success:function(){window.location.href=t}})})});var i=e.getElementsByTagName("form")[0];i&&i.addEventListener("submit",function(e){e.preventDefault(),e.currentTarget,n.trackConversion({success:function(){i.submit()}})})}(c,0,e);var u=function(e,n){t.showOverlay(e),n.trackImpression()};!function(e,t){t.reactEveryTime()?permutive.query(t.segmentCode,makeSafe(function(n){n.result?u(e,t):permutive.trigger(t.segmentCode,"result",function(n){n.result&&u(e,t)})})):t.reactOnEntry()?permutive.trigger(t.segmentCode,"result",makeSafe(function(n){n.result&&u(e,t)})):t.reactOnExit()&&permutive.trigger(t.segmentCode,"result",makeSafe(function(n){n.result||u(e,t)}))}(o,e)}()}return e.prototype.buildOverlayCss=function(e,t){return'<style type="text/css">.${overlay_class}{position:fixed;top:0;bottom:0;left:0;right:0;width:100%;height:100%;background:rgba(0,0,0,0.${opacity_percentage});transition:opacity ${opacity_transition_ms}ms;visibility:hidden;opacity:0;z-index:1000000;}.${modal_class}{position:fixed;padding:10px;background:#fff;border-radius:5px;z-index:1000001}.${modal_class} .content{overflow:auto;z-index:1000002;}.${modal_class} .close{position:absolute;top:20px;right:30px;transition:all 200ms;font-size:30px;font-weight:bold;text-decoration:none;color:#333;z-index:1000003}.${modal_class} .close:hover{color:orange;}</style>'.replace(/\${overlay_class}/g,"permutive-overlay-"+t).replace(/\${modal_class}/g,"permutive-modal-"+t).replace("${opacity_percentage}",e.opacity_percentage.toString()).replace("${opacity_transition_ms}",e.opacity_transition_ms.toString())},e.prototype.buildOverlayBody=function(e,t){var n="";return isHtmlOverlay_1(e)?n=e.html:isImageOverlay_1(e)&&(n='<a href="'+e.image_link+'"><img src="'+e.image_url+'"/></a>'),'<div id="${overlay_class}" class="${overlay_class}"><div id="${modal_class}" class="${modal_class}"><a class="close" href="javascript:;">&times;</a><div class="content">${content}</div></div></div>'.replace(/\${overlay_class}/g,"permutive-overlay-"+t).replace(/\${modal_class}/g,"permutive-modal-"+t).replace("${content}",n).replace(/<img /g,"<img onload='window.permutive.addons.overlays.loadedImage(\"permutive-overlay-"+t+"\")' ")},e.prototype.showOverlay=function(e){var t=this,n=document.getElementById(""+e),i=function(){var e=n.getElementsByTagName("div")[0],t=e.getBoundingClientRect().height,i=e.getBoundingClientRect().width;e.style.left=window.innerWidth/2-i/2+"px",e.style.top=window.innerHeight/2-t/2+"px",n.style.visibility="visible",n.style.opacity="1"},r=n.getElementsByTagName("img");if(r.length>0){var a=0,s=function(){a<10&&(!(e in t.loadedImageCounts)||t.loadedImageCounts[e]<r.length)?(a+=1,setTimeout(s,500)):i()};s()}else i()},e.prototype.loadedImage=function(e){e in this.loadedImageCounts?this.loadedImageCounts[e]=this.loadedImageCounts[e]+1:this.loadedImageCounts[e]=1},e}();permutive.q.push({functionName:"addon",arguments:["web",{auto_init:!0}]});var WebAddon=function(){function e(e){var t=this,e=e||{};this.eventInterval=e.eventInterval||5,this.initialised=!1,this.addAlchemyTaxonomy={auto_init:!0,track_form_submission:!0,track_link_click:!0,track_pageview_engagement:!0}.add_alchemy_taxonomy,this.addAlchemyEntities={auto_init:!0,track_form_submission:!0,track_link_click:!0,track_pageview_engagement:!0}.add_alchemy_entities,this.trackPageviewEngagement=!0,this.trackFormSubmission=!0,this.trackLinkClick=!0,this.page=e.page||null,this.sendPageviewEvent(),this.dirtyState=!1;var n=function(){t.dirtyState=!0};(e.dirtyEvents||["mousemove","click","scroll"]).map(function(e){window.addEventListener(e,n)}),this.totalCompletion=0,this.trackPageviewEngagement&&(this.timerHandle=setInterval(this.sendEngagementEvent(this.eventInterval,this.getCompletion),1e3*this.eventInterval));var i=function(){if(t.trackFormSubmission)for(var e=window.document.getElementsByTagName("form"),n=0;n<e.length;n++)e[n].addEventListener("submit",makeSafe(t.sendFormSubmissionEvent))},r=function(e,t){if(e.tagName.toLowerCase()===t)return e;for(var n=e.parentElement;null!==n;){if(n.tagName.toLowerCase()===t)return n;n=n.parentElement}return null};this.trackLinkClick&&document.body.addEventListener("click",function(e){var n=r(e.target,"a");if(n){var i=!("_blank"===n.target||e.metaKey||e.ctrlKey||e.shiftKey||2===e.which||3===e.which);t.sendLinkClickEvent(n,i)}}),"loading"!==document.readyState?i():window.addEventListener("DOMContentLoaded",i,!1),this.initialised=!0}return e.prototype.sendPageviewEvent=function(){var e={visit_id:_internals.state.getViewId(),isp_info:"$ip_isp_info",geo_info:"$ip_geo_info",alchemy:void 0};if(!0===permutive.context.isArticle&&(this.addAlchemyTaxonomy||this.addAlchemyEntities)){var t={};this.addAlchemyTaxonomy&&(t.taxonomy_labels="$alchemy_taxonomy_labels"),this.addAlchemyEntities&&(t.entity_names="$alchemy_entity_names"),e.alchemy=t}null!==this.page&&(e=PermutiveUtils.extend(e,this.page));var n={};this.initialised||(n.success=function(){_internals.metrics.trackTimeSinceInit("sdk_first_event_tracked_task_duration_seconds",{})}),permutive.track("Pageview",e,n)},e.prototype.getCompletion=function(){var e=document.documentElement.scrollHeight,t=window.pageYOffset+window.innerHeight;return t<=0?0:t>=e?1:t/e},e.prototype.sendEngagementEvent=function(e,t){var n=this;return makeSafe(function(){if(n.dirtyState){var i={visit_id:_internals.state.getViewId(),engaged_time:e},r=Math.max(n.totalCompletion,t());i.completion=r-n.totalCompletion,n.totalCompletion=r,i.total_completion=n.totalCompletion,n.dirtyState=!1,null!==n.page&&(i=PermutiveUtils.extend(i,n.page)),permutive.track("PageviewEngagement",i)}})},e.prototype.reset=function(e){_internals.state.viewId=_internals.randomUuid(),this.page=e.page||null,this.totalCompletion=0,this.sendPageviewEvent(),this.trackPageviewEngagement&&(clearInterval(this.timerHandle),this.timerHandle=setInterval(this.sendEngagementEvent(this.eventInterval,this.getCompletion),1e3*this.eventInterval))},e}();WebAddon.prototype.sendLinkClickEvent=function(e,t){if(window.location.href&&e.href){var n=0===e.href.indexOf("data:")?"NOT_URL":e.href;permutive.track("LinkClick",{dest_url:n},{useBeacon:t})}},WebAddon.prototype.sendFormSubmissionEvent=function(e){var t=function(e){for(var t,n,i,r={},a=function(e){if(e.forEach)return e.forEach(a);e&&e.length<=120&&(r[n]=e.toString())},s=e.getElementsByTagName("input"),o=0;o<s.length;o++){var c=s[o];t=c.id,i=c.type;var u=!1;(n=c.name||t)&&i&&t&&"email"!==i.toLowerCase()&&"tel"!==i.toLowerCase()||(u=!0),u||"fieldset"===c.nodeName.toLowerCase()||c.disabled||"submit"===i||"reset"===i||"button"===i||"file"===i||"password"===i||!("radio"!==i&&"checkbox"!==i||c.checked)||a(document.getElementById(c.id).value)}return r}(e.currentTarget),n=[];for(var i in t)n.push({name:i,value:t[i]});var r={method:this.method||"GET",properties:n};this.id&&(r.id=this.id),this.name&&"string"==typeof this.action&&(r.name=this.name),this.action&&"string"==typeof this.action&&(r.action=this.action),permutive.track("FormSubmission",{form:r})},function(){function e(e,t,n){var i=0,r=setInterval(function(){e()?clearInterval(r):i===n&&clearInterval(r),i++},t)}function t(){return{userId:_internals.state.getUserId(),visitId:_internals.state.getViewId(),sessionId:_internals.sessionManager.getSessionId(),client:_internals.state.getClient(),segments:_internals.state.queryManager.userSegments}}function n(e){var n=t();e.postMessage({type:"Init",data:n},"*"),e.postMessage({type:"permutive:init",data:n},"*"),_internals.messages.on("permutive:segments:updated",makeSafe(function(){e.postMessage({type:"permutive:update",data:t()},"*")}))}function i(){var t=document.getElementsByTagName("amp-brightcove");if(0!==t.length){[].slice.call(t).forEach(function(t){e(function(){var e=t.getElementsByTagName("iframe");return e.length>0&&(n(e[0].contentWindow),!0)},500,10)})}}function r(){var e=document.getElementsByTagName("iframe");0!==e.length&&[].slice.call(e).forEach(function(e){"amp-brightcove"!==e.parentNode.nodeName.toLowerCase()&&-1!==e.src.indexOf("brightcove")&&(n(e.contentWindow),e.addEventListener("load",function(){n(e.contentWindow)}))})}_internals.log("Starting brightcove integration");var a=function(){return"undefined"!=typeof videojs&&(Object.keys(videojs.players).forEach(function(e){videojs.players[e].on("loadedmetadata",function(){return n(window)})}),!0)},s=function(){r(),i(),window.addEventListener("load",function(){e(a,500,10)},!1)},o=function(){null!==_internals.state.getUserId()?s():_internals.messages.on("permutive:user:ready",s)};_internals.extMessages.listen("brightcove-init",o),o()}(),permutive.q.unshift({functionName:"addon",arguments:["scriptrunner",{}]});var ScriptRunnerAddon=function(){function ScriptRunnerAddon(options){this.reactions=_internals.state.reactionManager.getReactions("run_script");for(var i=0;i<this.reactions.length;i++){var reaction=this.reactions[i],run=function(reaction){var script=reaction.config.script.replace(/impression\(\)/g,"reaction.trackImpression();").replace(/conversion\(\)/g,"reaction.trackConversion();");try{eval(script)}catch(e){e.message="Error running custom script: "+e.message,_internals.error(e)}};!function(e){e.reactEveryTime()?permutive.query(e.segmentCode,function(t){t.result?run(e):permutive.trigger(e.segmentCode,"result",function(t){t.result&&run(e)})}):e.reactOnEntry()?permutive.trigger(e.segmentCode,"result",function(t){t.result&&run(e)}):e.reactOnExit()&&permutive.trigger(e.segmentCode,"result",function(t){t.result||run(e)})}(reaction)}}return ScriptRunnerAddon}();permutive.q.push({functionName:"addon",arguments:["appnexus",{}]});var AppNexusAddon=function(){function e(e){var t=this,n=_internals.state.getPermutiveData("addon:appnexus")||!1,i=_internals.state.queryManager.userSegmentsDict,r=_internals.state.reactionManager.getSpecializedReactions("appnexus"),a=!n,s=this;for(var o in r)!function(e){if(r.hasOwnProperty(e)){var n=r[e];permutive.trigger(parseInt(e),"",function(e){e.result&&t.firePixel(n)}),a&&e in i&&s.firePixel(n)}}(o);a&&_internals.state.setPermutiveData("addon:appnexus",!0),_internals.messages.on("permutive:reset",function(){_internals.state.setPermutiveData("addon:appnexus",!1)})}return e.prototype.firePixel=function(e){(new Image).src="https://secure.adnxs.com/seg?add="+e+"&t=1"},e}(),DFP_SEGMENTS_STORAGE_KEY="_pdfps",googleAdSlots={};permutive.q.push({functionName:"addon",arguments:["dfp",{}]}),window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],window.googletag.cmd.push(function(){permutive.ready(makeSafe(function(){var e=0;googletag.pubads&&googletag.pubads().getSlots&&googletag.pubads().getSlots().length>0&&googletag.pubads().getSlots().forEach(function(t){t.getResponseInformation()&&e++});var t=0===e?"sdk_targeting_realtime_success_count":"sdk_targeting_realtime_fail_count";_internals.metrics.track({name:t,value:1,labels:{target:"dfp"}})}),"realtime");var e=function(){var e=_internals.getExternalData(DFP_SEGMENTS_STORAGE_KEY);return e?JSON.parse(e):[]}();googletag.cmd.push(function(){googletag.pubads().setTargeting("permutive",e)});var t=function(e){for(var t={ad_unit_path:e.getAdUnitPath(),slot_element_id:e.getSlotElementId(),targeting_keys:[]},n={},i=e.getTargetingKeys(),r=0;r<i.length;r++){for(var a=i[r],s=[],o=e.getTargeting(a),c=0;c<o.length;c++)s.push(o[c].toString());s.length>0&&(n[a]=1,t.targeting_keys.push({key:a,value:s}))}for(var u=googletag.pubads().getTargetingKeys(),r=0;r<u.length;r++){s=[];if(void 0===n[a=u[r]]){for(var o=googletag.pubads().getTargeting(u[r]),c=0;c<o.length;c++)s.push(o[c].toString());s.length>0&&t.targeting_keys.push({key:a,value:s})}}return t},n=function(e){try{var t=!1;window.addEventListener("blur",function(){if(t){var n=googleAdSlots[e];n&&permutive.track("SlotClicked",n)}}),document.getElementById(e).addEventListener("mouseover",function(){t=!0}),document.getElementById(e).addEventListener("mouseout",function(){t=!1})}catch(e){}};googletag.pubads&&googletag.pubads().getSlots&&googletag.pubads().getSlots().forEach(function(e){var i=e.getResponseInformation();if(i){var r=e.getSlotElementId(),a={advertiser_id:i.advertiserId,campaign_id:i.campaignId,line_item_id:i.lineItemId,creative_id:i.creativeId,is_empty:!1,service_name:"publisher_ads",slot:t(e)};googleAdSlots[r]=a,permutive.track("SlotRendered",a,{isAnalyticsOnly:!0}),n(r)}}),googletag.cmd.push(function(){googletag.pubads().addEventListener("slotRenderEnded",function(e){var i=e,r=i.slot.getSlotElementId(),a={advertiser_id:i.advertiserId,campaign_id:i.campaignId,line_item_id:i.lineItemId,creative_id:i.creativeId,is_empty:i.isEmpty,service_name:i.serviceName,slot:t(e.slot)};i.size&&"number"==typeof i.size[0]&&"number"==typeof i.size[1]&&(a.width=i.size[0],a.height=i.size[1]),googleAdSlots[r]=a,permutive.track("SlotRendered",a,{isAnalyticsOnly:!0}),n(r)})}),window.addEventListener("message",function(e){try{var t=JSON.parse(e.data);if(t.permutive_type&&"google_ad_click"===t.permutive_type){var n=t.data.ad_unit_path,i=t.data.creative_id,r=void 0;Object.keys(googleAdSlots).forEach(function(e){void 0!==googleAdSlots[e].slot&&googleAdSlots[e].slot.ad_unit_path===n&&googleAdSlots[e].creative_id===i&&(r=googleAdSlots[e])}),r=r||{line_item_id:t.data.line_item_id,advertiser_id:t.data.advertiser_id,campaign_id:t.data.order_id,creative_id:i,is_empty:!1},permutive.track("SlotClicked",r)}}catch(e){}},!1)});var DFPAddon=function(){function e(e){var t=this;this.trackedTargetingLimitMetric=!1;var n=_internals.getExternalData(DFP_SEGMENTS_STORAGE_KEY);this.liveSegments=n?JSON.parse(n):[],this.eligibleSegments={};for(var i=_internals.state.reactionManager.getSpecializedReactions("target_dfp"),r=0;r<i.dfp.length;r++){var a=i.dfp[r];this.eligibleSegments[a]=a}for(var s in i.dfp_legacy)if(i.dfp_legacy.hasOwnProperty(s)){var o=i.dfp_legacy[s];this.eligibleSegments[s]=o}var c=_internals.state.queryManager.userSegments;this.updateSegments(this.filterSegments(c)),_internals.messages.emit("permutive:dfp:ready"),_internals.messages.on("permutive:segments:updated",makeSafe(function(){var e=_internals.state.queryManager.userSegments;t.updateIfNecessary(e)})),_internals.messages.on("permutive:reset",makeSafe(function(){_internals.removeExternalData(DFP_SEGMENTS_STORAGE_KEY),_internals.deleteCookie(DFP_SEGMENTS_STORAGE_KEY),t.liveSegments=[]}))}return e.prototype.updateIfNecessary=function(e){var t=this.filterSegments(e);_internals.arraysEqual(t,this.liveSegments)||this.updateSegments(t)},e.prototype.updateSegments=function(e){var t=this.processActivations(_internals.thirdParty.getActivationMetadata()),n=e.concat(t);encodeURIComponent(JSON.stringify(n)).length>1500&&(n=e,this.trackedTargetingLimitMetric||(_internals.metrics.track({name:"sdk_targeting_size_limit_exceeded_count",value:1,labels:{target:"dfp"}}),this.trackedTargetingLimitMetric=!0)),window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],window.googletag.cmd.push(function(){googletag.pubads().setTargeting("permutive",n.concat(["rts"]))});var i=JSON.stringify(n);_internals.setExternalData(DFP_SEGMENTS_STORAGE_KEY,i),_internals.setCookie(DFP_SEGMENTS_STORAGE_KEY,i),this.liveSegments=e},e.prototype.filterSegments=function(e){var t=this;return e.filter(function(e){return e in t.eligibleSegments}).map(function(e){return t.eligibleSegments[e]})},e.prototype.processActivations=function(e){var t=[];for(var n in e)if(e.hasOwnProperty(n)&&n in this.eligibleSegments)for(var i=0;i<e[n].length;i++)t.push(e[n][i]);return t},e}();_internals.messages.on("permutive:blockers:empty",function(){_internals.eventHandler=new EventHandler;var e=new PermutiveMethods;PermutiveUtils.extend(permutive,e),permutive.config.exposeInternals&&PermutiveUtils.extend(permutive,_internals),_internals.setAsReady(),_internals.applyQueue(),delete permutive.q,_internals.messages.emit("permutive:queue:executed")});var retrieveThirdPartyIdentities_1=function(){return _internals.identities.retrieveAllIdentities()},initThirdPartyState=function(){return retrieveThirdPartyIdentities_1().then(function(e){return _internals.thirdParty.segments().then(function(){return _internals.thirdParty.fireThirdPartySegmentEvent()}),e})},initIdentity=function(){var e=PermutiveUtils.deferredPromise();if(_internals.log("<call> init identity "),null===_internals.state.getUserId()){var t=_internals.randomUuid();_internals.log("Cookie user id is null, creating new id: "+t),_internals.state.setUserId(t)}_internals.state.setUserId(_internals.state.getUserId()),permutive.context.user_id=_internals.state.userId,permutive.q.filter(function(e){return"identify"===e.functionName}).forEach(function(e){return makeSafe(function(){var t=PermutiveIdentities.getAliasesFromIdentifyArg(e.arguments[0]);_internals.api.identify(t)})()}),permutive.q=permutive.q.filter(function(e){return"identify"!==e.functionName});var n=_internals.identities.previousAliases,i=_internals.identities.currentAliases;if(_internals.identities.areAliasesEqual(n,i))_internals.log("Aliases are equal, skipping identifying...",n,i),e.resolve({identityChanged:!1,userId:_internals.state.userId});else{_internals.log("Aliases have changed...",n,i);var r=_internals.state.userId,a={success:function(t){var n=t.user_id,a=!1;n!==r&&(_internals.log("Got different user id from API: "+n),_internals.state.reset(),_internals.state.setUserId(n),a=!0),_internals.identities.storeAliases(i),e.resolve({identityChanged:a,userId:n})},error:function(){_internals.error("Couldn't set identity for user "+r),e.resolve({identityChanged:!1,userId:r})}};_internals.api.sendIdentify(r,i,a)}return e.promise.then(function(e){_internals.messages.emit("permutive:user:ready"),_internals.setIdentityReady(),_internals.log("<done> init identity ",e)}),e.promise},identityChanged_1=function(){_internals.log("Identity has changed");var e=_internals.state.eventsCache.refresh({from:new Date(0)});return _internals.state.eventsCache.setReady(),e.then(function(e){var t=_internals.state.eventsCache.processRefreshEvents(e,{write:!0});return _internals.log("Retrieved full event history from API"),_internals.state.queryManager.updateSegmentResults(t),_internals.state.queryManager.initWorker(t)})},identityRemained_1=function(){_internals.log("Identity hasn't changed");var e=_internals.state.eventsCache.refresh();return eventCache_1.then(function(e){_internals.log("Loaded local event cache");var t=_internals.state.eventsCache.processCachedEvents(e);return _internals.state.eventsCache.setReady(),_internals.state.queryManager.initWorker(t)}).then(function(){return e}).then(function(e){var t=_internals.state.eventsCache.processRefreshEvents(e,{write:!0});return _internals.log("Updating query states with unseen events from API (#e)",t.length),_internals.state.queryManager.updateWithHistoricSegments(t)})};initThirdPartyState().then(initIdentity).then(function(e){return e.identityChanged?identityChanged_1():identityRemained_1()}).then(function(){return Promise.all([_internals.thirdParty.segments(),_internals.models.getModels()]).then(function(e){return _internals.log("Loaded TPD segments and lookalike models",e),_internals.state.queryManager.updateEnvironment({segments:PermutiveUtils.merge({"1p":_internals.state.queryManager.userSegmentsDict},e[0]),lookalikeModels:e[1]})}).then(function(){_internals.state.queryManager.setAsReady()})}).then(function(){_internals.messages.emit("permutive:api:ready")}),_internals.messages.emit("permutive:library:loaded")}catch(e){_internals.error(e)}}var wwSupport=!!window.Worker&&!!window.Blob,mod="modernizr",lsSupport=!0;try{localStorage.setItem(mod,mod),localStorage.removeItem(mod)}catch(e){lsSupport=!1}if(wwSupport&&lsSupport){var sdkInitTimestamp=void 0;void 0!==window.performance&&void 0!==window.performance.now&&(sdkInitTimestamp=performance.now());var LZBlob=new Blob([("("+lzWorkerFunction+")();").replace('"use strict";',"")],{type:"application/javascript"}),LZWorkerBlobURL=URL.createObjectURL(LZBlob),worker=new Worker(LZWorkerBlobURL),counter=0,LZWorker={compress:function(e,t){worker.onmessage=function(e){t(e.data)},worker.postMessage({type:"compress",value:e})},decompress:function(e,t){worker.onmessage=function(e){t(e.data)},worker.postMessage({type:"decompress",value:e})}};!function(e){function t(){}function n(e,t){return function(){e.apply(t,arguments)}}function i(e){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],u(e,this)}function r(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,i._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var i;try{i=n(e._value)}catch(e){return void s(t.promise,e)}a(t.promise,i)}else(1===e._state?a:s)(t.promise,e._value)})):e._deferreds.push(t)}function a(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var r=t.then;if(t instanceof i)return e._state=3,e._value=t,void o(e);if("function"==typeof r)return void u(n(r,t),e)}e._state=1,e._value=t,o(e)}catch(t){s(e,t)}}function s(e,t){e._state=2,e._value=t,o(e)}function o(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)r(e,e._deferreds[t]);e._deferreds=null}function c(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function u(e,t){var n=!1;try{e(function(e){n||(n=!0,a(t,e))},function(e){n||(n=!0,s(t,e))})}catch(e){if(n)return;n=!0,s(t,e)}}if(!e.Promise){var l=setTimeout;i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,n){var i=new this.constructor(t);return r(this,new c(e,n,i)),i},i.prototype.finally=function(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){return t.reject(n)})})},i.all=function(e){return new i(function(t,n){function i(e,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var o=s.then;if("function"==typeof o)return void o.call(s,function(t){i(e,t)},n)}r[e]=s,0==--a&&t(r)}catch(e){n(e)}}if(!e||void 0===e.length)throw new TypeError("Promise.all accepts an array");var r=Array.prototype.slice.call(e);if(0===r.length)return t([]);for(var a=r.length,s=0;s<r.length;s++)i(s,r[s])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(t){t(e)})},i.reject=function(e){return new i(function(t,n){n(e)})},i.race=function(e){return new i(function(t,n){for(var i=0,r=e.length;i<r;i++)e[i].then(t,n)})},i._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){l(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},e.Promise=i}}(window);var PermutiveUtils=function(){function e(){}return e.mergeNestedObjects=function(e,t){return[e,t].reduce(function(e,t){return Object.keys(t).forEach(function(n){e[n]=t[n]}),e},{})},e.merge=function(e,t){return this.extend(e,t)},e.extend=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e=e||{};for(var i=1;i<arguments.length;i++)if(arguments[i])for(var r in arguments[i])e[r]=arguments[i][r];return e},e.swap=function(e){var t={};for(var n in e)t[e[n]]=n;return t},e.lens=function(e,t){var n,i=t.length;for(n=0;"object"==typeof e&&n<i;++n)e=e[t[n]];return e},e.deferredPromise=function(){var e,t;return{promise:new Promise(function(n,i){e=n,t=i}),reject:t,resolve:e}},e.ajax=function(e){return new Promise(function(t,n){var i={},r=e.dataType?e.dataType:"json",a=new XMLHttpRequest;if(e.contentType&&function(e,t){i[e.toLowerCase()]=[e,t]}("Content-Type",e.contentType),a.onload=function(){t("json"===r?this.responseText?JSON.parse(this.responseText):null:"text"===r?this.responseText:this.response)},a.onerror=function(){_internals.error("Failed AJAX request"),n(new TypeError("Network request failed"))},a.ontimeout=function(){_internals.error("AJAX request timed out"),n(new TypeError("Network request timed out"))},e.beforeSend&&e.beforeSend(a),a.open(e.type?e.type:"GET",e.url,!0),e.timeout&&(a.timeout=e.timeout),e.xhrFields)for(var s in e.xhrFields)a[s]=e.xhrFields[s];for(var o in i)i.hasOwnProperty(o)&&a.setRequestHeader(i[o][0],i[o][1]);a.send(e.data?e.data:null)})},e.poller=function(e,t,n){function i(e,t,s){if(!(a||r>=n)){var o=null;try{o=e()}catch(e){return}o?t():setTimeout(function(){r++,i(e,t,2*s)},s)}}void 0===n&&(n=30);var r=0,a=!1;return i(e,t,50),{cancel:function(){a=!0}}},e}(),permutive=window.permutive,PERMUTIVE_CONFIG={default:{apiHost:"api.permutive.com",cdnBaseUrl:"cdn.permutive.com",apiVersion:"v2.0",apiProtocol:"https",loggingEnabled:!1,requestTimeout:5e3,cookieName:"permutive-id",cookieExpiry:threeYearsFromNow(),permutiveDataKey:"permutive-data",stateNamespace:"",sendClientErrors:!0,storeIP:!1,exposeInternals:!1,metricsSamplingPercentage:10},production:{},development:{apiProtocol:"http",loggingEnabled:!0,sendClientErrors:!1,exposeInternals:!0}};permutive.config.cookieDomain="."+extractDomain(window.location.hostname),Object.keys(PERMUTIVE_CONFIG.default).forEach(function(e){var t=e;void 0!==permutive.config[t]||(void 0!==PERMUTIVE_CONFIG[permutive.config.environment][t]?permutive.config[t]=PERMUTIVE_CONFIG[permutive.config.environment][t]:permutive.config[t]=PERMUTIVE_CONFIG.default[t])});var PermutiveMetricsNoOp=function(){function e(){}return e.prototype.track=function(e){},e.prototype.trackTimeSinceInit=function(e,t){},e.prototype.startTimer=function(e,t){},e.prototype.stopTimer=function(e,t){},e}(),PermutiveMetrics=function(){function e(e,t){void 0===t&&(t=5);var n=this;this.sdkInitTimestamp=e,this.pendingMetrics=[],this.pendingTimers={},permutive.ready(function(){window.setInterval(n.processPending.bind(n),1e3*t),window.addEventListener("beforeunload",function(){n.processPending.bind(n)},!1)}),this.track({name:"sdk_initialisation_start_time_seconds",value:e/1e3,labels:{}})}return e.prototype.track=function(e){this.pendingMetrics.push(e)},e.prototype.trackTimeSinceInit=function(e,t){var n=performance.now();this.track({name:e,value:(n-this.sdkInitTimestamp)/1e3,labels:t})},e.prototype.startTimer=function(e,t){var n=performance.now();this.pendingTimers[this.getUniqueKey(e,t)]={startTime:n,labels:t}},e.prototype.stopTimer=function(e,t){var n=this.pendingTimers[this.getUniqueKey(e,t)];if(n){var i=performance.now();this.track({name:e,value:(i-n.startTime)/1e3,labels:n.labels}),delete this.pendingTimers[e]}},e.prototype.processPending=function(){this.pendingMetrics.length>0&&(_internals.api.metrics({context:{environment:"web",events_count:_internals.state.eventsCache.all().length,segments_count:Object.keys(_internals.state.queryManager.queryStateMap).length},items:this.pendingMetrics}),this.pendingMetrics=[])},e.prototype.getUniqueKey=function(e,t){return e+":"+JSON.stringify(t)},e}(),PermutiveCore=function(){function e(e){this.listenForBlockers=!0,this.clientErrorsSent=0,this.isReady=!1,this.isRealtime=!1,this.isIdentityReady=!1,this.config=e}return e.prototype.getEndpointUrl=function(e){return this.config.apiProtocol+"://"+this.config.apiHost+"/"+this.config.apiVersion+e},e.prototype.utcNow=function(){var e=new Date;return new Date(e.toUTCString())},e.prototype.req=function(e){var t=this,n=e.url,i=e.method||"GET",r="";e.data&&e.jsonInParams?r={data:encodeURIComponent(JSON.stringify(e.data))}:e.data&&(r=JSON.stringify(e.data));var a=e.contentType?e.contentType:e.jsonInParams?"application/x-www-form-urlencoded":"application/json",s=function(e){e.setRequestHeader("X-API-Key",t.config.apiKey)};if(e.apiKeyInParams&&("GET"===i?(s=function(){},-1===n.indexOf("?")?n+="?k="+this.config.apiKey:n+="&k="+this.config.apiKey):"POST"===i&&(s=function(){},n+="?k="+this.config.apiKey)),e.useBeacon&&navigator.sendBeacon){var o=navigator.sendBeacon(n,r);if(e.complete&&e.complete("200"),o)return e.success&&e.success(r),Promise.resolve(r);var c="Failed to queue beacon";return e.error&&e.error(c),Promise.reject(c)}return PermutiveUtils.ajax({type:i,url:n,contentType:a,dataType:e.dataType?e.dataType:"json",data:r,timeout:this.config.timeout,beforeSend:s}).then(function(t){return e.success&&e.success(t),t},function(t){return e.error&&e.error(t),null}).then(function(t){return e.complete&&e.complete("200"),t})},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.config.loggingEnabled&&window.console&&window.console.log&&(e.splice(0,0,"[Permutive]"),console.log.apply(console,e))},e.prototype.error=function(e){if(this.config.sendClientErrors){if(this.clientErrorsSent>3)return;this.clientErrorsSent+=1;var t={user_id:void 0!==_internals.state?_internals.state.userId:"",domain:window.location.hostname?window.location.hostname:"",url:window.location.href?window.location.href:"",referrer:document.referrer?document.referrer:"",user_agent:navigator.userAgent?navigator.userAgent:"",error_message:"",stack_trace:"",additional_details:""};e instanceof Error?(void 0!==e.message&&(t.error_message=e.message.toString()),void 0!==e.stack&&(t.stack_trace=e.stack.toString())):t.additional_details=e.toString(),this.req({url:this.getEndpointUrl("/internal/errors"),method:"POST",data:t,contentType:"text/plain",dataType:"text",apiKeyInParams:!0})}else window.console&&(window.console.error?window.console.error("[Permutive]",e):window.console.log&&window.console.log("[Permutive]",e))},e.prototype.createUser=function(e){e({user_id:_internals.randomUuid()})},e.prototype.applyQueue=function(){for(var e=[],t=[],n=[],i=[],r=[],a=0;a<permutive.q.length;a++)"identify"===(o=permutive.q[a]).functionName?e.push(o):"trigger"===o.functionName?t.push(o):"addon"===o.functionName?n.push(o):"track"===o.functionName?i.push(o):r.push(o);for(var s=e.concat(t).concat(n).concat(i).concat(r),a=0;a<s.length;a++){var o=s[a];o.functionName in permutive?permutive[o.functionName].apply(permutive,o.arguments):this.error('Function "permutive.'+o.functionName+'" does not exist.')}},e.prototype.setAsReady=function(){this.isReady=!0,_internals.metrics.trackTimeSinceInit("sdk_initialisation_task_duration_seconds",{}),_internals.messages.emit("permutive:ready")},e.prototype.setAsRealtime=function(){this.isRealtime=!0,_internals.metrics.trackTimeSinceInit("sdk_realtime_targeting_set_task_duration_seconds",{}),_internals.messages.emit("permutive:realtime")},e.prototype.setIdentityReady=function(){this.isIdentityReady=!0,_internals.messages.emit("permutive:identity:ready")},e.prototype.addBlocker=function(e){var t=this;_internals.blockers.push(e),this.log("<blockers> added blocker "+e),_internals.messages.on(e,function(){if(t.listenForBlockers){var n=_internals.blockers.indexOf(e);n>=0&&(_internals.blockers.splice(n,1),t.log("<blockers> removed blocker "+e)),0===_internals.blockers.length&&(t.listenForBlockers=!1,_internals.messages.emit("permutive:blockers:empty"),t.log("<blockers> complete"))}})},e.prototype.getNamespacedStorageKey=function(e){return""+permutive.config.stateNamespace+e},e.prototype.setCookie=function(e,t){if(!(t&&e&&this.config.cookieExpiry&&this.config.cookieDomain))return!1;var n=_internals.getNamespacedStorageKey(e);return document.cookie=encodeURIComponent(n)+"="+encodeURIComponent(t)+"; expires="+this.config.cookieExpiry+"; domain="+this.config.cookieDomain+"; path=/",!0},e.prototype.getCookie=function(e,t){void 0===t&&(t=!1);var n=t?e:_internals.getNamespacedStorageKey(e),i=new RegExp(encodeURIComponent(n)+"=([^;]+)").exec(document.cookie);return null!==i?decodeURIComponent(i[1]):null},e.prototype.deleteCookie=function(e){if(!e||!this.config.cookieDomain)return!1;var t=_internals.getNamespacedStorageKey(e);return document.cookie=encodeURIComponent(t)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; domain="+this.config.cookieDomain+"; path=/",!0},e.prototype.getExternalData=function(e){var t=_internals.getNamespacedStorageKey(e);return localStorage.getItem(t)},e.prototype.setExternalData=function(e,t){var n=_internals.getNamespacedStorageKey(e);localStorage.setItem(n,t)},e.prototype.removeExternalData=function(e){var t=_internals.getNamespacedStorageKey(e);localStorage.removeItem(t)},e.prototype.randomUuid=function(){var e=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})},e.prototype.arraysEqual=function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0},e}(),PermutivePromises=function(){function e(){this.promises={}}return e.prototype.addPromise=function(e,t,n,i){var r=this;e in this.promises||(this.promises[e]={}),this.promises[e][t]=i,window.setTimeout(function(){r.resolvePromise(e,t)},n)},e.prototype.createPromise=function(e,t,n){this.addPromise(e,t,n,PermutiveUtils.deferredPromise())},e.prototype.getPromise=function(e,t){return PermutiveUtils.lens(this.promises,[e,t])},e.prototype.resolvePromise=function(e,t){var n=this.getPromise(e,t);return void 0!==n?(n.resolve(),n):void 0},e.prototype.getPromisesByCategory=function(e){var t=PermutiveUtils.lens(this.promises,[e])||{};return Object.keys(t).map(function(e){return t[e]})},e}(),_internals=new PermutiveCore(permutive.config),initialised=!1,handleConsent=function(e){return"object"==typeof e&&(localStorage.setItem("permutive-consent",JSON.stringify(e)),e.opt_in&&null!==e.token&&e.token.length>0)};permutive.consent=function(e){handleConsent(e)&&!initialised&&(initialiseSDK(),initialised=!0)};for(var i=0;i<permutive.q.length;i++){var funcCall=permutive.q[i];if("consent"===funcCall.functionName){var consentData=funcCall.arguments[0];handleConsent(consentData)&&!initialised&&(initialiseSDK(),initialised=!0)}}if(permutive.q=permutive.q.filter(function(e){return"consent"!==e.functionName}),!initialised){var cachedConsentData=JSON.parse(localStorage.getItem("permutive-consent")),optIn=cachedConsentData?cachedConsentData.opt_in:void 0;permutive.config.consentRequired&&optIn?initialiseSDK():permutive.config.consentRequired||!1===optIn||initialiseSDK()}}}();